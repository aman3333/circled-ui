import{a as D,g as S,e as U,d as G,j as o,a5 as L,B as F,h as H,T as s,s as N,i as m,c as n,n as r,o as i,p as R,q as E}from"./index-tWVfh1a_.js";import{G as M}from"./google-login-TOBpJPnJ.js";import{u as W}from"./Onboarding-CSV0hQFI.js";const f=N(R)(({theme:k})=>({height:52,alignItems:"center",borderRadius:40,background:"#fff",border:"1.5px solid #C3CBD9",borderColor:"#C3CBD9",fontFamily:"Proxima Nova",paddingLeft:"12px",color:"#172A44",fontSize:16,fontWeight:"bold",border:"1.5px solid "}));function Y({mode:k,open:b,type:x,onClose:y}){const a=D(),g=S(),c=U(),{state:h,pathname:d}=G(),p=t=>{a(n({loading:!0})),r.post(`${i.protocol}${i.baseUrl}${i.userLogin}`,{email:t==null?void 0:t.profileObj.email,authType:"gmail",phone:"",tokenId:t.tokenId}).then(e=>{a(n({loading:!1,snackbar:!0,message:"Login successfuly",severity:"success"}));let{_id:l,category:u,name:w,bio:v,type:C,DOB:I,privatePlan:T,profilePic:$,location:B,links:P,email:O,phone:A}=e.data.userData;r.defaults.headers.common.Authorization=e.data.token,localStorage.setItem("token",e.data.token),a(E({_id:l,category:u,name:w,bio:v,type:C,authType:"gmail",DOB:I,privatePlan:T,profilePic:$,location:B,links:P,email:O,token:e.data.token,phone:A,password:"",...e.data.userData})),c(d)}).catch(e=>{if(e.response&&e.response.status===404)return a(n({loading:!1,snackbar:!0,message:"User with provided email or phone doesn't exist",severity:"error"}));if(e.response&&e.response.status===409)return a(n({loading:!1,snackbar:!0,message:"Invalid Password",severity:"error"}));e.response&&e.response.status===408&&(a(n({loading:!1})),g.showConfirmationModal("Alert!","This email is already registered with other auth provide , would you like to link gmail with this account?","Yes","No").then(l=>{l&&(a(n({loading:!0})),r.patch(`${i.protocol}${i.baseUrl}${i.updateAuth}`,{email:t==null?void 0:t.profileObj.email,authType:"gmail",tokenId:t.tokenId}).then(u=>{a(n({loading:!1,snackbar:!0,message:"Account linked with gmail , login to continue",severity:"success"}))}))}))})},j=t=>{a(n({loading:!0})),r.get(`${i.protocol}${i.baseUrl}${i.checkUserExistence}email=${t==null?void 0:t.profileObj.email}`).then(e=>{a(n({loading:!1})),e.data.authType.includes("gmail")?p(t):g.showConfirmationModal("Alert!","This email is already registered with other auth provide , would you like to link gmail with this account?","Yes","No").then(l=>{l&&(a(n({loading:!0})),r.patch(`${i.protocol}${i.baseUrl}${i.updateAuth}`,{email:e.data.email,authType:"gmail",tokenId:t.tokenId}).then(u=>{p(t)}))})}).catch(e=>{a(n({loading:!1})),e.response.status===404&&(a(W({name:t==null?void 0:t.profileObj.name,email:t==null?void 0:t.profileObj.email,profilePic:t==null?void 0:t.profileObj.imageUrl,tokenId:t.tokenId,authType:"gmail"})),c("/onboarding/client/info",{state:{...h,redirect:d}}))})};return o.jsx(L,{sx:{maxHeight:380,borderRadius:2},onClose:()=>y(),BackdropProps:{style:{backgroundColor:"rgba(0, 0, 0, 0.2)",backdropFilter:"none"}},elevation:24,anchor:"bottom",open:b,PaperProps:{sx:{borderRadius:1}},children:o.jsx(F,{display:"flex",alignItems:"center",width:"100%",justifyContent:"center",flexGrow:1,px:3,pb:2,pt:3,children:o.jsxs(H,{spacing:1,alignItems:"center",width:"100%",children:[o.jsx(s,{variant:"h2",mt:2,children:"Sign up or login to start"})," ",o.jsxs(s,{align:"center",color:"text.secondary",gutterBottom:!0,children:["To start the ",x," you must ",o.jsx("br",{}),"sign up or login."]}),o.jsx(s,{align:"center",gutterBottom:!0,children:"If you have an account we’ll log you in."}),o.jsx(M,{clientId:"20299471486-m23pkgk770a4vq3dgjh8uc9k180cpc98.apps.googleusercontent.com",render:t=>o.jsxs(f,{style:{marginTop:16},onClick:t.onClick,disabled:t.disabled,fullWidth:!0,children:[o.jsx(m,{icon:"flat-color-icons:google",width:24,height:24}),"  ",o.jsx(s,{variant:"h6",color:"text.primary",children:"Continue with Google"})]}),buttonText:"Login",onSuccess:j,onFailure:t=>{console.log(t)},cookiePolicy:"single_host_origin"}),o.jsxs(f,{onClick:()=>c("/onboarding/client",{state:{...h,redirect:d}}),fullWidth:!0,style:{marginTop:16,marginBottom:16},children:[o.jsx(m,{icon:"fontisto:email",width:24,height:24}),"   ",o.jsx(s,{variant:"h6",color:"text.primary",children:"Continue with Email  "})]})]})})})}export{Y as H};
