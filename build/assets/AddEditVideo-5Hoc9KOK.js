import{a as A,d as N,r as a,e as W,j as t,s as T,S as $,C as q,B as r,I as H,T as j,h as C,p as S,cc as O,n as G,o as b,bg as k,cd as J,c as K}from"./index-tWVfh1a_.js";import{P as Q}from"./Page-D7TsOLpr.js";import{S as X}from"./Header-C-6_pkkN.js";import{a as D,b as I}from"./sync-CFO_F30W.js";import{C as Y}from"./Circular-CdB5voB0.js";import{a as Z}from"./convertToLink-D3DGDIAW.js";import{A as _}from"./ArrowLeft-lA8HnlgG.js";import{R as ee}from"./ReactPlayerWithFallback-Zm03AunA.js";import{M as te}from"./bottomDrawer-DMtCRIBf.js";import{M as R}from"./Model-Bs8FCq2d.js";import{I as oe}from"./InputBase-7pV38TnQ.js";import{S as ae}from"./Slider-DuuEQ67Z.js";import"./index-DmwG6s5l.js";import"./ReactPlayer-B1HYrz8S.js";import"./memoize-one.esm-Cbrq43TT.js";import"./Close-0gM9I1tD.js";import"./TabContext-CXvaiNSx.js";import"./TabPanel-D7TYthF4.js";import"./Tabs-Cs2QRRdO.js";import"./useFormControl-BEzaUW9U.js";import"./useControlled-DiwPEJyR.js";const re=T("div")(()=>({backgroundColor:"#F2F5F9",height:"100%"})),se=T(r)(()=>({width:"100%",zIndex:100,backgroundColor:"#fff",boxShadow:"0px 4px 54px rgba(225, 231, 240, 0.5)",borderRadius:"0px 0px 8px 8px"}));function Te(){const s=A(),{state:e}=N(),v=a.useRef(null),u=W(),[d,U]=a.useState(e==null?void 0:e.triggerMuscle),[c,M]=a.useState(e==null?void 0:e.title),[w,n]=a.useState(0),[g,m]=a.useState(!1),[f,P]=a.useState(null),[L,h]=a.useState(!0),[z,B]=a.useState(0),E=()=>{e.mode=="add"?F(e.file):s(O({...e,title:c,triggerMuscle:d})).then(()=>u(-1))},F=async o=>{const i=o;let p=new Date().getTime();new FormData().append("file",i),G.post(`${b.protocol}${b.baseUrl}${b.getSignedUrl}`,{title:c,name:i.name,type:"application/octet-stream",savedToLibrary:!0}).then(x=>{m(!0);let y=k.CancelToken.source();P(y),n(0),s(D(p,{source:y,...e,mode:"upload",type:"video",progress:0,title:c,id:p})),k.put(x.data,i,{cancelToken:y.token,headers:{"Content-Type":"application/octet-stream"},onUploadProgress:l=>{n(Math.round(l.loaded/l.total*100)),s(D(p,{progress:Math.round(l.loaded/l.total*100)}))}}).then(l=>{s(I(p)),m(!1),n(100),s(J({...e,key:decodeURI(x.data.split("?")[0].replace("https://circled-videos.s3.us-east-1.amazonaws.com/","")),title:c,triggerMuscle:d})).then(()=>u(-1))}).catch(l=>{s(I(p)),n(0),m(!1)}),u(-1)}).catch(x=>{console.log(x),m(!1),s(K({message:"Error uploading video",type:"error"}))})},V=a.useMemo(()=>e!=null&&e.key?Z(e==null?void 0:e.key,"/"):URL.createObjectURL(e.file),[e==null?void 0:e.key,e.file]);return t.jsx(re,{children:t.jsxs(Q,{title:" Simplified Online Fitness Training ",children:[t.jsxs($,{children:[" ",t.jsxs(q,{style:{paddingLeft:0,paddingRight:0},children:[t.jsx(X,{position:"absolute",noColor:!0,children:t.jsx(se,{px:2,py:2,style:{background:"linear-gradient(rgba(0,0,0,1), rgba(0,0,0,0.1))"},children:t.jsx(r,{width:"100%",display:"flex",alignItems:"center",flexDirection:"row",justifyContent:"space-between",children:t.jsxs(r,{display:"flex",alignItems:"center",flexDirection:"row",children:[t.jsx(H,{onClick:()=>u(-1,{replace:!0,state:{tab:1,sds:2}}),sx:{color:"common.white"},children:t.jsx(_,{})}),t.jsx(j,{variant:"body1",color:"text.primary",children:t.jsxs(j,{component:"span",variant:"h6",color:"common.white",children:[e.mode=="edit"?"Edit":"Upload"," video"]})})]})})})}),g?t.jsx(r,{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",children:t.jsxs(C,{spacing:1,children:[t.jsx("center",{children:t.jsx(Y,{variant:"determinate",value:w,size:120})}),t.jsx("center",{children:t.jsx(j,{children:"Uploading video..."})}),t.jsx(S,{color:"error",onClick:()=>{f==null||f.cancel()},children:"Cancel"})]})}):t.jsxs(r,{display:"flex",position:"relative",children:[t.jsx("div",{className:"player-wrapper",style:{height:"100vh",width:"100vw",display:"flex",alignItems:"center"},children:t.jsx(ee,{url:V,raw:"https://circled-videos.s3.us-east-1.amazonaws.com/"+(e==null?void 0:e.key),loop:!0,controls:!1,autoPlay:!0,responsive:!0,playsinline:!0,width:"100vw",height:"auto",playing:L,onProgress:o=>{n(o.playedSeconds)},onDuration:o=>{B(o)},progressInterval:100,ref:v})}),t.jsx(r,{position:"absolute",bottom:0,width:"100vw",px:2,style:{background:"linear-gradient(rgba(0,0,0,0), rgba(0,0,0))"},children:t.jsxs(C,{mt:4,children:[t.jsx(te,{setMData:o=>U(o),data:[{name:(e==null?void 0:e.title)||"",muscles:d||[],frequency:1}],width:150,children:t.jsxs(r,{display:"flex",alignItems:"center",children:[t.jsx(R,{data:[{name:(e==null?void 0:e.title)||"",muscles:d||[],frequency:1}],style:{width:"220px",padding:"5px"},highlightedColors:["#EE3737"]}),t.jsx(R,{type:"posterior",data:[{name:e==null?void 0:e.title,muscles:d||[],frequency:1}],style:{width:"220px",padding:"5px"},highlightedColors:["#EE3737"]})]})}),t.jsx(oe,{value:c,disabled:g,onChange:o=>M(o.target.value),defaultValue:e==null?void 0:e.title,placeholder:"Write here",fullWidth:!0,sx:{mt:2,mb:2,borderRadius:1,py:.5,background:"rgba(0,0,0,0.5)",border:"2px solid #fff","& input":{color:"#fff",paddingLeft:2,textAlign:"left"}},InputProps:{sx:{"& input":{color:"#fff",textAlign:"left"}}}}),t.jsx(r,{children:t.jsx(ae,{size:"large",min:0,max:z,value:w,onDragStart:o=>{h(!1)},onDragEnd:o=>{h(!0)},onChangeCommitted:(o,i)=>{h(!0)},onChange:(o,i)=>{h(!1),v.current.seekTo(i,"seconds"),n(i)}})}),t.jsx(r,{mb:4,display:"flex",justifyContent:"flex-end",width:"100%",children:t.jsx(S,{sx:{px:4,fontSize:18,fontWeight:500},size:"small",variant:"contained",disabled:g,onClick:E,children:e.mode=="edit"?"Save":"Upload"})})]})})]})]})]})," "]})})}export{Te as default};
