import{a as U,g as P,e as G,d as z,j as e,h as x,s as H,i as C,T as a,c as r,n as p,o as c,p as I,q as M,b as R,r as v,u as q,S as A,C as B,B as u,am as F}from"./index-tWVfh1a_.js";import{P as O}from"./Page-D7TsOLpr.js";import{G as W}from"./google-login-TOBpJPnJ.js";import{u as Y}from"./Onboarding-CSV0hQFI.js";import{s as _}from"./common-C0dnEDq7.js";import{c as Q,a as J,r as K}from"./invite-v8sERg3b.js";import{A as V}from"./Avatar-DYK8RM-C.js";const L=H(I)(({theme:l})=>({height:52,alignItems:"center",borderRadius:40,background:"#fff",border:"1.5px solid #C3CBD9",borderColor:"#C3CBD9",fontFamily:"Proxima Nova",paddingLeft:"12px",color:"#172A44",fontSize:16,fontWeight:"bold",border:"1.5px solid "}));function X(l){const s=U(),j=P(),h=G(),{state:T}=z(),g=t=>{s(r({loading:!0})),p.post(`${c.protocol}${c.baseUrl}${c.userLogin}`,{email:t==null?void 0:t.profileObj.email,authType:"gmail",phone:"",tokenId:t.tokenId}).then(i=>{s(r({loading:!1,snackbar:!0,message:"Login successfuly",severity:"success"}));let{_id:m,category:y,name:E,bio:o,type:f,DOB:S,privatePlan:$,profilePic:k,location:b,links:w,email:d,phone:N}=i.data.userData;p.defaults.headers.common.Authorization=i.data.token,localStorage.setItem("token",i.data.token),s(M({_id:m,category:y,name:E,bio:o,type:f,authType:"gmail",DOB:S,privatePlan:$,profilePic:k,location:b,links:w,email:d,token:i.data.token,phone:N,password:"",...i.data.userData})),l.redirect&&h(l.redirect)}).catch(i=>{if(i.response&&i.response.status===404)return s(r({loading:!1,snackbar:!0,message:"User with provided email or phone doesn't exist",severity:"error"}));if(i.response&&i.response.status===409)return s(r({loading:!1,snackbar:!0,message:"Invalid Password",severity:"error"}));i.response&&i.response.status===408&&(s(r({loading:!1})),j.showConfirmationModal("Alert!","This email is already registered with other auth provide , would you like to link gmail with this account?","Yes","No").then(m=>{m&&(s(r({loading:!0})),p.patch(`${c.protocol}${c.baseUrl}${c.updateAuth}`,{email:t==null?void 0:t.profileObj.email,authType:"gmail",tokenId:t.tokenId}).then(y=>{s(r({loading:!1,snackbar:!0,message:"Account linked with gmail , login to continue",severity:"success"}))}))}))})},n=t=>{s(r({loading:!0})),p.get(`${c.protocol}${c.baseUrl}${c.checkUserExistence}email=${t==null?void 0:t.profileObj.email}`).then(i=>{s(r({loading:!1})),i.data.authType.includes("gmail")?g(t):j.showConfirmationModal("Alert!","This email is already registered with other auth provide , would you like to link gmail with this account?","Yes","No").then(m=>{m&&(s(r({loading:!0})),p.patch(`${c.protocol}${c.baseUrl}${c.updateAuth}`,{email:i.data.email,authType:"gmail",tokenId:t.tokenId}).then(y=>{g(t)}))})}).catch(i=>{s(r({loading:!1})),i.response.status===404&&(s(Y({name:t==null?void 0:t.profileObj.name,email:t==null?void 0:t.profileObj.email,profilePic:t==null?void 0:t.profileObj.imageUrl,tokenId:t.tokenId,authType:"gmail"})),h(`/onboarding/${(l==null?void 0:l.mode)=="client"||(l==null?void 0:l.type)=="Athlete"?"client/info":"preview"}`,{state:{...T,...l}}))})};return e.jsxs(x,{spacing:2,children:[e.jsx(W,{clientId:"20299471486-m23pkgk770a4vq3dgjh8uc9k180cpc98.apps.googleusercontent.com",render:t=>e.jsxs(L,{style:{marginTop:16},onClick:t.onClick,disabled:t.disabled,fullWidth:!0,children:[e.jsx(C,{icon:"flat-color-icons:google",width:24,height:24}),"  ",e.jsx(a,{variant:"h6",color:"text.primary",children:"Continue with Google"})]}),buttonText:"Login",onSuccess:n,onFailure:t=>{console.log(t)},cookiePolicy:"single_host_origin"}),e.jsxs(L,{onClick:()=>h((l==null?void 0:l.type)=="Athlete"?"/onboarding/client":"/onboarding",{state:{...T,...l}}),fullWidth:!0,style:{marginTop:16,marginBottom:16},children:[e.jsx(C,{icon:"fontisto:email",width:24,height:24}),"   ",e.jsx(a,{variant:"h6",color:"text.primary",children:"Continue with Email  "})]})]})}function Z(){return new URLSearchParams(z().search)}function se({mode:l}){var k,b,w;const s=G(),j=Z(),h=U(),{state:T}=z(),{token:g}=R(),[n,t]=v.useState(null),[i,m]=v.useState(!1),[y,E]=v.useState(!1),o=q(d=>d.Profile),f=j.get("userexist");v.useEffect(()=>{h(Q(g)).then(d=>{t(d),console.log(d)}).catch(d=>{d.status=="404"&&m(!0)})},[]);const S=()=>{h(J(g)).then(d=>{s("/")})},$=()=>{h(K(g)).then(d=>{s("/")})};return i?e.jsx(O,{title:" Simplified Online Fitness Training ",children:e.jsx(A,{children:e.jsxs(B,{display:"flex",height:"100%",flexDirection:"column",alignItems:"center",flexGrow:"1",px:2,pt:6,children:[e.jsx(u,{display:"flex",justifyContent:"center",alignItems:"center",mt:8,children:e.jsx("img",{src:F,height:46})}),e.jsx(u,{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",pt:4,children:e.jsxs(x,{alignItems:"center",spacing:1,children:[e.jsx(C,{icon:"ant-design:stop-outlined",sx:{fontSize:100,color:"text.secondary",my:4}}),e.jsx(a,{variant:"h2",color:"text.secondary",sx:{textTransform:"capitalize"},children:"Link Expired"}),e.jsx(a,{variant:"h4",children:"Provided link no longer exists"})]})})]})})}):o!=null&&o.token&&(o==null?void 0:o.email)!==(n==null?void 0:n.email)?e.jsx(O,{title:" Simplified Online Fitness Training ",children:e.jsx(A,{children:e.jsxs(B,{display:"flex",height:"100%",flexDirection:"column",alignItems:"center",flexGrow:"1",px:2,pt:6,children:[e.jsx(u,{display:"flex",justifyContent:"center",alignItems:"center",mt:8,children:e.jsx("img",{src:F,height:46})}),e.jsxs(u,{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",pt:4,children:[e.jsxs(x,{alignItems:"center",spacing:1,children:[e.jsx(C,{icon:"ant-design:stop-outlined",sx:{fontSize:100,color:"text.secondary",my:4}}),e.jsx(a,{variant:"h2",color:"text.secondary",sx:{textTransform:"capitalize"},children:"Unauthorized Access"}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs(a,{variant:"h4",sx:{mt:4},align:"center",children:["This invite was sent to ",e.jsx(a,{color:"primary",children:n==null?void 0:n.email})]}),e.jsxs(a,{align:"center",children:["Please login with ",n==null?void 0:n.email," ",e.jsx("br",{}),"to accept invite"]})]}),e.jsx("br",{}),e.jsxs(I,{sx:{mt:4},onClick:()=>_(),children:["Click here to signout from ",o==null?void 0:o.email]})]})]})})}):e.jsx(O,{title:" Simplified Online Fitness Training ",children:e.jsx(A,{children:e.jsxs(B,{display:"flex",height:"100%",flexDirection:"column",alignItems:"center",flexGrow:"1",px:2,pt:6,children:[e.jsx(u,{display:"flex",justifyContent:"center",alignItems:"center",mt:8,children:e.jsx("img",{src:F,height:46})}),e.jsxs(u,{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",pt:4,children:[n?e.jsxs(x,{alignItems:"center",spacing:1,children:[o!=null&&o.token?e.jsx(V,{src:(k=n==null?void 0:n.invitedBy)==null?void 0:k.profilePic,sx:{width:100,height:100}}):"",f=="true"?e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"h2",color:"text.secondary",sx:{textTransform:"capitalize"},children:(b=n==null?void 0:n.invitedBy)==null?void 0:b.name}),e.jsx(a,{variant:"h2",align:"center",children:o!=null&&o.token?e.jsxs(e.Fragment,{children:["Has invited you to be on",e.jsx("br",{}),"his client list"]}):"has sent you an invitation"})]}):e.jsx(e.Fragment,{children:e.jsxs(a,{variant:"h2",align:"center",children:["Create an account to ",e.jsx("br",{}),"accept  ",e.jsx(a,{component:"span",variant:"h2",color:"text.secondary",sx:{textTransform:"capitalize"},children:(w=n==null?void 0:n.invitedBy)==null?void 0:w.name}),"  invitation."]})})]}):"",o.token?e.jsxs(x,{width:"100%",mt:3,spacing:2,children:[e.jsx(a,{align:"center",color:"text.secondary",children:"By accepting the trainer will be able to view your health information and can send or create programs for you."}),e.jsx("br",{}),e.jsxs(x,{width:"100%",mt:3,spacing:2,direction:"row",justifyContent:"center",children:[e.jsx(I,{size:"small",variant:"text",onClick:$,sx:{bgcolor:"#E1E7F0",color:"text.primary"},children:"Reject"}),e.jsx(I,{size:"small",variant:"contained",onClick:S,children:"Accept"})]})]}):e.jsxs(x,{width:"100%",mt:3,spacing:2,children:[f=="true"?e.jsxs(a,{align:"center",component:"span",children:["You account ",e.jsx(a,{component:"span",color:"text.secondary",children:n==null?void 0:n.email})," already Exists"]}):e.jsxs(a,{align:"center",children:["Make sure to sign in using this email",e.jsx("br",{}),e.jsx(a,{align:"center",color:"text.secondary",children:n==null?void 0:n.email})]}),f=="true"?e.jsx(a,{align:"center",variant:"h3",children:"Login to view the invitation"}):e.jsx(a,{}),e.jsx(X,{redirect:`${window.location.pathname}${window.location.search}`,type:"Athlete"})]})]})]})})})}export{se as default};
