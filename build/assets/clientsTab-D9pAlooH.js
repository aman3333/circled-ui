import{r as s,e as J,a as Q,d as ee,ac as b,j as e,a5 as te,B as r,T as a,h as c,i as W,p as A,c as $,c0 as ie,u as E,g as ne,s as h,S as re,I as Y,C as ae,f as oe}from"./index-tWVfh1a_.js";import{P as se}from"./Page-D7TsOLpr.js";import{T as R}from"./TextMaxLine-BUlHRtTt.js";import{S as le}from"./Header-C-6_pkkN.js";import{S as ce}from"./Footer-BU_S36Uf.js";import{s as K}from"./search-qBW2W_DU.js";import{g as de}from"./chat-DxkSMC6D.js";import{P as me}from"./Program-D9Gjowai.js";import{C as xe}from"./Client-CpOPCSnx.js";import{D as he}from"./DB-D1UkOgeB.js";import{C as X}from"./index.es-dZk2dlKh.js";import{h as q}from"./moment-G82_0lEo.js";import{L as ue}from"./LabeledInput-B3Qf7l4R.js";import{c as pe,b as G}from"./array-DbNmRnh0.js";import{u as ge,F as fe,a as je}from"./formik.esm-jmAInz8L.js";import{b as Z,s as ye,d as ve}from"./invite-v8sERg3b.js";import{u as be}from"./useSocket-DMLHsbDK.js";import{T as we}from"./TextField-cyeEFY3i.js";import{I as Ce}from"./InputAdornment-DiI_gVyu.js";import{G as N}from"./Grid-C2UtAwNz.js";import{A as U}from"./Avatar-DYK8RM-C.js";import{D as Se}from"./Divider-0_Mpg1Be.js";import{B as ke}from"./BottomNavigation-9Rm09L7N.js";import{B as Te}from"./BottomNavigationAction-CGNV9ctf.js";import"./Link-D6ktmyc-.js";import"./isObject-MojUmidT.js";import"./OutlinedInput-D3YoqtXT.js";import"./useFormControl-BEzaUW9U.js";import"./InputBase-7pV38TnQ.js";import"./Popover-COOgvQR_.js";import"./ListContext-BQPXTeBj.js";import"./useControlled-DiwPEJyR.js";import"./isMuiElement-CENM59Ut.js";import"./dividerClasses-ClaZwgHh.js";function H(i){var v,t;const[u,w]=s.useState(!1);J();const C=Q(),{state:g}=ee(),[z,_]=s.useState(!1),[m,f]=s.useState(!1),[p,B]=s.useState(null),V=pe().shape({email:G().email("enter a valid email").required("Email is required"),message:G().nullable()}),D=ge({initialValues:{email:(v=i==null?void 0:i.item)==null?void 0:v.email},validationSchema:V,onSubmit:async(n,{setErrors:o,setSubmitting:x,resetForm:d})=>{var I;f(!0),C((i==null?void 0:i.mode)=="Edit"?Z({_id:(I=i==null?void 0:i.item)==null?void 0:I._id}):ye(n)).then(P=>{f(!1),d(),C(b()),B(P)}).catch(P=>{P.status==403&&o({email:P.data.message})})}}),{errors:S,touched:j,handleSubmit:l,isSubmitting:F,getFieldProps:k,setFieldValue:O,resetForm:L,values:T}=D;s.useEffect(()=>{u&&(B(null),L(),f(!1))},[u]);const y=n=>o=>{o&&o.type==="keydown"&&(o.key==="Tab"||o.key==="Shift")||(o.stopPropagation(),w(n))};return e.jsxs("div",{children:[e.jsx(te,{anchor:"bottom",PaperProps:{sx:{borderTopLeftRadius:12,borderTopRightRadius:12}},open:u,onClose:y(!1),onOpen:y(!0),children:e.jsx(r,{padding:"16px 24px 36px",style:{borderTopLeftRadius:"8px",borderTopRightRadius:"8px",backgroundColor:"#fff"},children:e.jsx(fe,{value:D,children:e.jsxs(je,{autoComplete:"off",noValidate:!0,onSubmit:l,children:[!p&&e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"h3",align:"left",sx:{mt:2,mb:1},children:"Enter your clients email address"}),e.jsxs(a,{color:"text.secondary",children:["By entering the clients email address you ",e.jsx("br",{}),"will invite him to your client list"]})]}),e.jsxs(c,{spacing:2,mt:2,sx:{width:"100%"},children:[p?"":e.jsx(ue,{fullWidth:!0,placeholder:"Example@email.com",disabled:(i==null?void 0:i.mode)=="Edit",clabel:e.jsx(a,{variant:"subtitle1",children:"Email"}),...k("email"),error:!!(j.email&&S.email),helperText:j.email&&S.email}),p&&e.jsxs(e.Fragment,{children:[" ",e.jsx("center",{children:e.jsx(W,{icon:"lets-icons:check-fill",sx:{fontSize:80}})}),e.jsx(a,{variant:"h2",align:"center",children:"Invitaion sent successfully"}),e.jsx(a,{variant:"body2",align:"center",children:"We have sent an invitaion to the email address you provided. You can also copy invitation link and send via other modes"}),e.jsx(A,{variant:"text",onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/invite/accept-invite/${p}`),C($({snackbar:!0,message:"Link copied to clipboard",severity:"success"}))},children:"Copy invitation link"})]})]}),e.jsx(r,{sx:{width:"100%",mt:6},children:e.jsx(r,{display:"flex",justifyContent:"flex-end",children:(i==null?void 0:i.mode)=="Edit"?e.jsx(X,{autoStart:!0,date:new Date().getTime()+(9e4-(new Date().getTime()-new Date((t=i==null?void 0:i.item)==null?void 0:t.updatedAt).getTime())),renderer:({hours:n,minutes:o,seconds:x,completed:d})=>d?e.jsx(A,{variant:"contained",type:"submit",sx:{px:4},children:"Resend"}):e.jsxs(a,{variant:'"body2',color:"primary",children:[o,":",x," until resend"]})}):e.jsx(e.Fragment,{children:p?e.jsx(A,{variant:"contained",type:"submit",fullWidth:!0,onClick:()=>w(!1),sx:{px:4,borderRadius:1},children:"Close"}):e.jsx(ie,{loading:m,variant:"contained",type:"submit",fullWidth:!0,disabled:!T.email,sx:{px:4,borderRadius:1},children:"Send invite"})})})})]})})})}),e.jsx("div",{onClick:n=>{w(!0)},children:i.children})]})}const Ie=h("div")(()=>({backgroundColor:"#fff",height:"100%"}));h(r)(()=>({position:"relative"}));h(r)(()=>({position:"absolute",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",paddingTop:52,paddingBottom:24,zIndex:100,top:0}));h(oe)(({theme:i})=>({height:45,borderRadius:16,background:"#F9FCFD",fontFamily:"Proxima Nova",color:"#172A44",fontSize:18,fontWeight:"bold",width:"100%",marginBottom:8,border:"2px solid rgba(23, 42, 68, 0.5)"}));h(r,{shouldForwardProp:i=>i!=="isClientSide"})(({isClientSide:i,theme:u})=>({backgroundColor:u.palette.primary.main,borderRadius:"24px",color:"#fff",display:"flex",width:"24px",height:"24px",justifyContent:"center",alignItems:"center",fontSize:14}));const M=h(Te)({" &.Mui-selected":{fontWeight:600}});h(r)(({theme:i})=>({display:"flex",width:"100%",justifyContent:"center"}));function lt(){const[i,u]=s.useState(!0),[w,C]=s.useState([{},{},{},{},{},{}]),g=J(),[z,_]=s.useState("clients"),[m,f]=s.useState(""),[p,B]=s.useState("active"),[V,D]=s.useState(0),{socket:S,isConnected:j}=be(),l=Q();s.useEffect(()=>{l(de()),l(b())},[]),s.useEffect(()=>{j&&S.on("accept-invite",t=>{l(b())})},[j]),E(t=>t.Profile);const F=E(t=>t.ProgramList.clients.clients),k=E(t=>t.ProgramList.clients.pending),{showConfirmationModal:O}=ne(),L=t=>{O("Are you sure?","You are going to delete this invitation","Delete").then(n=>{n&&l(ve(t)).then(o=>{l(b())})})};q.updateLocale("en",{relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"1 min",mm:"%d min",h:"1 hr",hh:"%d hr",d:"1 day",dd:"%d days",M:"1 month",MM:"%d months",y:"1 year",yy:"%d years"}});const T=t=>{l(Z({_id:t})).then(n=>{l(b())})},{pendingClients:y,clientsList:v}=s.useMemo(()=>{if(m=="")return{pendingClients:k,clientsList:F};const t=K(k,["email"],m),n=K(F,["client.name","userPurchaseProgram.Program.Title"],m);return{pendingClients:t,clientsList:n}},[m]);return e.jsx(Ie,{children:e.jsxs(se,{title:"Notifications",children:[e.jsxs(re,{children:[" ",e.jsxs(le,{children:[e.jsx(r,{pt:2,borderRadius:4,overflow:"hidden",children:e.jsxs(r,{width:"100%",display:"flex",px:2,alignItems:"center",justifyContent:"space-between",children:[e.jsxs(r,{display:"flex",alignItems:"center",children:[e.jsx(a,{variant:"body1",color:"text.primary",children:e.jsx(r,{display:"flex",alignItems:"center",children:e.jsx(a,{color:"text.primary",sx:{fontSize:18,fontWeight:"bold"},children:"Client"})})})," "]})," "]})}),e.jsx(r,{sx:{px:2,mt:2},children:e.jsx(we,{fullWidth:!0,placeholder:"Search name, tag or program",value:m,onChange:t=>f(t.target.value),InputProps:{sx:{height:48},endAdornment:e.jsx(Ce,{position:"end",children:e.jsx(Y,{children:e.jsx(W,{icon:"eva:search-fill",width:24,height:24,sx:{color:"#95A3B8"}})})})},sx:{mb:2}})})]})," ",e.jsxs(ae,{withoutPadding:!0,style:{paddingTop:8,paddingBottom:48,overflowY:"auto",position:"relative"},children:[e.jsx(r,{display:"flex",alignItems:"center",ml:2,mb:2,children:e.jsx(a,{color:"primary",sx:{fontSize:18},children:e.jsx(H,{children:"Invite client"})})}),[...v,...y].length?e.jsxs(N,{container:!0,spacing:0,mt:2,children:[y.map(t=>{var n;return e.jsx(N,{item:!0,xs:12,children:e.jsxs(r,{width:"100%",height:"100%",px:2,children:[e.jsx(c,{spacing:0,width:"100%",direction:"row",alignItems:"center",justifyContent:"space-between",children:e.jsxs(c,{direction:"row",spacing:2,width:"100%",children:[e.jsx(U,{src:(n=t==null?void 0:t.client)==null?void 0:n.profilePic,sx:{width:48,height:48}}),e.jsxs(c,{width:"100%",children:[e.jsx(H,{mode:"Edit",item:t,children:e.jsxs(c,{sx:{width:"100%"},width:"100%",direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsx(a,{line:1,align:"center",color:"grey.400",sx:{maxWidth:"65vw",overflow:"hidden",textOverflow:"ellipsis"},component:"div",variant:"subtitle1",children:t==null?void 0:t.email}),e.jsx(Y,{onClick:o=>{o.stopPropagation(),L(t._id)},children:e.jsx(W,{icon:"ic:round-close",sx:{fontSize:24,color:"error.main"}})})]})}),e.jsxs(c,{mt:.5,children:[e.jsxs(c,{direction:"row",justifyContent:"space-between",children:[e.jsx(R,{line:2,variant:"body2",color:"text.secondary",component:"span",children:"(Invite sent)"}),e.jsx(a,{variant:"caption",align:"center",children:q(t.updatedAt).fromNow()})]}),new Date().getTime()-new Date(t.updatedAt).getTime()<12e4?e.jsx(X,{autoStart:!0,date:new Date().getTime()+(9e4-(new Date().getTime()-new Date(t==null?void 0:t.updatedAt).getTime())),renderer:({hours:o,minutes:x,seconds:d,completed:I})=>I?e.jsxs(r,{display:"flex",children:[e.jsx(a,{color:"primary.main",variant:"body2",onClick:()=>T(t._id),children:"Resend"}),"   ",e.jsx(a,{variant:"body2",color:"primary",onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/invite/accept-invite/${t._id}`),l($({snackbar:!0,severity:"success",message:"Link copied"}))},children:"Copy invite link"})]}):e.jsxs(a,{variant:"body2",color:"primary",children:[x,":",d," until resend"]})},t==null?void 0:t._id):e.jsxs(r,{display:"flex",children:[e.jsx(a,{color:"primary.main",variant:"body2",onClick:()=>T(t._id),children:"Resend"}),"   ",e.jsx(a,{variant:"body2",color:"primary",onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/invite/accept-invite/${t._id}`),l($({snackbar:!0,severity:"success",message:"Link copied"}))},children:"Copy invite link"})]})]})]})]})}),e.jsx(Se,{sx:{mt:2,mb:2,borderColor:"#E1E7F0"}})]})})}),v.map(t=>{var n,o,x,d;return e.jsx(N,{item:!0,xs:12,children:e.jsx(r,{width:"100%",height:"100%",px:2,mb:3,onClick:()=>g("/clientProfile/"+t._id),children:e.jsx(c,{spacing:0,direction:"row",alignItems:"center",justifyContent:"space-between",children:e.jsxs(c,{direction:"row",spacing:2,children:[e.jsx(U,{src:(n=t==null?void 0:t.client)==null?void 0:n.profilePic,sx:{width:48,height:48}}),e.jsxs(c,{children:[e.jsxs(c,{direction:"row",alignItems:"center",children:[e.jsx(R,{line:1,align:"center",variant:"subtitle1",sx:{textTransform:"capitalize"},children:(o=t==null?void 0:t.client)==null?void 0:o.name}),"  "]}),e.jsxs(R,{line:2,variant:"body1",color:"text.secondary",children:[((d=(x=t==null?void 0:t.userPurchaseProgram)==null?void 0:x.Program)==null?void 0:d.Title)||"No program"," "]})]})]})})})})})]}):e.jsx(r,{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",children:e.jsx(a,{sx:{maxWidth:240},align:"center",variant:"body1",color:"text.secondary",children:"You don't have any active client"})})]}),e.jsx(ce,{children:e.jsxs(ke,{sx:{borderTop:"1px solid #E1E7F0",borderRadius:"24px 24px 0px 0px",paddingTop:"12px",paddingBottom:"12px",height:"auto"},showLabels:!0,value:z,onChange:(t,n)=>{_(n),n=="program"?g("/instructor",{replace:!0}):n=="library"?g("/library",{replace:!0}):g("/clientView",{replace:!0})},children:[e.jsx(M,{sx:[{"&.MuiBottomNavigationAction-root":{color:t=>t.palette.text.secondary},"&.Mui-selected":{color:t=>t.palette.primary.main}}],label:"Programs",value:"program",color:i?"secondary.main":"primary.main",icon:e.jsx(me,{})}),e.jsx(M,{label:"Clients",value:"clients",sx:[{"&.MuiBottomNavigationAction-root":{color:t=>t.palette.text.secondary},"&.Mui-selected":{color:t=>t.palette.primary.main}}],icon:e.jsx(xe,{sx:{fontSize:28}})}),e.jsx(M,{label:"Library",value:"library",sx:[{"&.MuiBottomNavigationAction-root":{color:t=>t.palette.text.secondary},"&.Mui-selected":{color:t=>t.palette.primary.main}}],icon:e.jsx(he,{sx:{fontSize:24}})})]})})]})," "]})})}export{lt as default};
