import{r as l,a as I,U as j,e as M,g as A,_ as u,j as g,C as O,a2 as R}from"./index-tWVfh1a_.js";import{u as _,a as $,D as F,M as N,c as L,W as U,T as Y,P as q}from"./workoutWeek-CnKE-hW2.js";import{S as z,a as B}from"./Walkthrough-DXggXs_W.js";import"./TextMaxLine-BUlHRtTt.js";import"./Link-D6ktmyc-.js";import"./LibrarySelector-BSF-MZAA.js";import"./Page-D7TsOLpr.js";import"./Workout-eTy7zLdJ.js";import"./convertToLink-D3DGDIAW.js";import"./ImageWithFallback-C5zvNA0Z.js";import"./Circular-CdB5voB0.js";import"./More-BqGLUvK6.js";import"./edit-DiWhq57E.js";import"./Delete-fvKHvwYo.js";import"./ReactPlayerWithFallback-Zm03AunA.js";import"./index-DmwG6s5l.js";import"./ReactPlayer-B1HYrz8S.js";import"./memoize-one.esm-Cbrq43TT.js";import"./search-qBW2W_DU.js";import"./ArrowLeft-lA8HnlgG.js";import"./Checkbox-5Xdp7ogM.js";import"./SwitchBase-Bs2jeD_h.js";import"./useFormControl-BEzaUW9U.js";import"./useControlled-DiwPEJyR.js";import"./Divider-0_Mpg1Be.js";import"./dividerClasses-ClaZwgHh.js";import"./YouTube-BrIpEXBG.js";import"./Dumbell-LvyqFLuX.js";import"./MenuItem-BRbCqEYh.js";import"./ListContext-BQPXTeBj.js";import"./Share-D8xeKOeo.js";import"./CopyLink-DOxHVA9c.js";import"./moment-G82_0lEo.js";import"./Header-C-6_pkkN.js";import"./footer-BJqjd-0J.js";import"./Footer-BU_S36Uf.js";import"./TextField-cyeEFY3i.js";import"./OutlinedInput-D3YoqtXT.js";import"./InputBase-7pV38TnQ.js";import"./Popover-COOgvQR_.js";import"./isMuiElement-CENM59Ut.js";import"./InputAdornment-DiI_gVyu.js";import"./Tabs-Cs2QRRdO.js";import"./DB-D1UkOgeB.js";import"./SaveCheck-1m_e5Ncs.js";import"./createSvgIcon-UmMwsC2Z.js";import"./SwipeableDrawer-BEL-t-Lb.js";import"./index-BrBV3hc8.js";import"./routepath-BdjIj9sL.js";import"./AddCircled-C-pHs73y.js";import"./trash-CssX9TdV.js";import"./index-Cp5sxvbr.js";import"./warning-C20GYw-A.js";import"./LinearProgress-C4AIhOO1.js";const Qe=l.forwardRef((G,k)=>{const x=I(),[n,c]=l.useState(null),[i,d,y,H]=j();M();const{showConfirmationModal:h}=A(),[p,m]=l.useState(null),[J,f]=l.useState(!1);l.useEffect(()=>{k.current={}},[]);const E=(t,r,s,a)=>{if(t===r&&s===a)return;let e={...i.ExercisePlan};if(e.weeks[r].days[a].Exercise.length)h("Are you sure ?",`You are going to replace (week ${Number(r)+1} - day ${Number(a)+1}) exercises with (week ${t+1} - day ${s+1}). This process is irreversible`,"Replace","Cancel").then(o=>{if(o)e.weeks[r].days[a].Exercise=[...e.weeks[t].days[s].Exercise],e.weeks[r].days[a].Title=e.weeks[t].days[s].Title,x(d({ExercisePlan:e}));else return});else{let o={...e.weeks[t].days[s]};e.weeks[r].days[a]=o,e.weeks[t].days[s]={...o,_id:String(R())},x(d({ExercisePlan:e}))}},P=(t,r,s,a)=>{let e=u.cloneDeep(i.ExercisePlan),o=u.cloneDeep(e.weeks[t].days),b=B(o,s,a);e.weeks[t].days=b,x(d({ExercisePlan:e}))},v=_($("ontouchstart"in window||navigator.maxTouchPoints>0?Y:q,{activationConstraint:{tolerance:5,delay:100}})),w=l.useCallback(t=>{let r=i.ExercisePlan.weeks.findIndex(a=>a.days.findIndex(e=>e._id==t)!=-1),s=i.ExercisePlan.weeks[r].days.findIndex(a=>a._id==t);return{week:r,day:s}},[i.ExercisePlan]),D=t=>{if(f(!0),t.active.id){let{week:r,day:s}=w(t.active.id);m({week:r,day:s})}else m(null)},C=t=>{if(f(!1),!n||!p){m(null),c(null);return}let r=u.cloneDeep(i.ExercisePlan),s=p.week,a=p.day,e=n.week,o=n.day;p.week!==n.week&&i.ExercisePlan.weeks[n.week].days[n.day].Exercise.length==0?r.weeks[e].days[o].Exercise.length==0&&!r.weeks[e].days[o].Title&&E(s,e,a,o):s==e&&P(s,e,a,o),m(null),c(null)},S=t=>{m(null)},T=l.useMemo(()=>u.debounce(t=>{var r;if((r=t.over)!=null&&r.id){let{week:s,day:a}=w(t.over.id);c({week:s,day:a})}else c(null)},50),[w]);return g.jsxs(O,{style:{paddingTop:16,paddingLeft:0,paddingRight:0,background:"#F5F7FA"},children:[g.jsx(z,{Program:i}),g.jsx(F,{sensors:v,collisionDetection:L,onDragStart:D,onDragEnd:C,onDragOver:T,onDragCancel:S,measuring:{droppable:{strategy:N.Always}},children:g.jsx(U,{Program:i,updateProgram:d,mode:y,destData:n,sourceData:p})})]})});export{Qe as default};
