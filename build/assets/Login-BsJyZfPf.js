import{a as E,d as G,g as R,e as U,j as e,S as z,C as N,s as g,B as n,am as _,T as h,h as H,f as V,p as D,i as M,c as s,n as c,o as r,q as B}from"./index-tWVfh1a_.js";import{P as Y}from"./Page-D7TsOLpr.js";import{c as J,b as I}from"./array-DbNmRnh0.js";import{u as K,F as Q,a as X}from"./formik.esm-jmAInz8L.js";import{L as Z}from"./LabeledInput-B3Qf7l4R.js";import{L as ee}from"./PasswordInput-D_vhx4J8.js";import{H as te}from"./header-Bo2DC4uj.js";import{G as oe}from"./google-login-TOBpJPnJ.js";import{D as ae}from"./Divider-0_Mpg1Be.js";import"./isObject-MojUmidT.js";import"./TextField-cyeEFY3i.js";import"./OutlinedInput-D3YoqtXT.js";import"./useFormControl-BEzaUW9U.js";import"./InputBase-7pV38TnQ.js";import"./Popover-COOgvQR_.js";import"./ListContext-BQPXTeBj.js";import"./useControlled-DiwPEJyR.js";import"./isMuiElement-CENM59Ut.js";import"./createSvgIcon-UmMwsC2Z.js";import"./InputAdornment-DiI_gVyu.js";import"./Header-C-6_pkkN.js";import"./ArrowLeft-lA8HnlgG.js";import"./dividerClasses-ClaZwgHh.js";const ie=g("div")(()=>({display:"flex",flexDirection:"column",flex:1,flexGrow:1}));g(n)(()=>({position:"relative"}));g(n)(()=>({position:"absolute",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",paddingTop:52,paddingBottom:24,zIndex:100,top:0}));const se=g(D)(({theme:t})=>({height:52,alignItems:"center",borderRadius:40,background:"#fff",border:"1.5px solid #C3CBD9",borderColor:"#C3CBD9",boxShadow:"0px 4px 4px rgba(43, 64, 87, 0.1)",fontFamily:"Proxima Nova",paddingLeft:"12px",color:"#172A44",fontSize:16,fontWeight:"bold",marginBottom:8,border:"1.5px solid "}));function Fe(){const t=E(),{state:l}=G(),F=J().shape({email:I().email("Email must be a valid email address").required("Email is required"),password:I().required("Password is required")}),T=R(),S=K({initialValues:{email:l==null?void 0:l.email,password:"",confirmPass:""},validationSchema:F,onSubmit:async(o,{setErrors:a,setSubmitting:d})=>{d(!0),t(s({loading:!0})),c.post(`${r.protocol}${r.baseUrl}${r.userLogin}`,{phone:"",password:o.password,email:o.email}).then(i=>{t(s({loading:!1,snackbar:!0,message:"Login successfuly",severity:"success"}));let{_id:f,category:x,name:b,bio:y,type:j,DOB:w,privatePlan:k,profilePic:v,location:C,links:P,email:A,phone:W}=i.data.userData;c.defaults.headers.common.Authorization=i.data.token,localStorage.setItem("token",i.data.token),t(B({_id:f,category:x,name:b,bio:y,type:j,DOB:w,privatePlan:k,profilePic:v,location:C,links:P,email:A,token:i.data.token,phone:W,password:"",...i.data.userData})),l.redirect&&m(l.redirect)}).catch(i=>{if(i.response&&i.response.status===404)return t(s({loading:!1,snackbar:!0,message:"User with provided email or phone doesn't exist",severity:"error"}));if(i.response&&i.response.status===409)return t(s({loading:!1,snackbar:!0,message:"Invalid Password",severity:"error"}))})}}),$=o=>{t(s({loading:!0})),c.post(`${r.protocol}${r.baseUrl}${r.userLogin}`,{email:o==null?void 0:o.profileObj.email,authType:"gmail",phone:""}).then(a=>{t(s({loading:!1,snackbar:!0,message:"Login successfuly",severity:"success"}));let{_id:d,category:i,name:f,bio:x,type:b,DOB:y,privatePlan:j,profilePic:w,location:k,links:v,email:C,phone:P}=a.data.userData;c.defaults.headers.common.Authorization=a.data.token,localStorage.setItem("token",a.data.token),t(B({_id:d,category:i,name:f,bio:x,type:b,authType:"gmail",DOB:y,privatePlan:j,profilePic:w,location:k,links:v,email:C,token:a.data.token,phone:P,password:"",...a.data.userData})),l.redirect&&m(l.redirect)}).catch(a=>{if(a.response&&a.response.status===404)return t(s({loading:!1,snackbar:!0,message:"User with provided email or phone doesn't exist",severity:"error"}));if(a.response&&a.response.status===409)return t(s({loading:!1,snackbar:!0,message:"Invalid Password",severity:"error"}));a.response&&a.response.status===408&&(t(s({loading:!1})),T.showConfirmationModal("Alert!","This email is already registered with other auth provide , would you like to link gmail with this account?","Yes","No").then(d=>{d&&(t(s({loading:!0})),c.patch(`${r.protocol}${r.baseUrl}${r.updateAuth}`,{email:o==null?void 0:o.profileObj.email,authType:"gmail"}).then(i=>{t(s({loading:!1,snackbar:!0,message:"Account linked with gmail , login to continue",severity:"success"}))}))}))})},m=U(),{errors:p,touched:u,handleSubmit:O,isSubmitting:re,getFieldProps:L,setFieldValue:ne,values:q}=S;return e.jsx(Y,{title:" Simplified Online Fitness Training ",children:e.jsxs(z,{children:[e.jsx(te,{title:"Login",onClose:()=>m("/",{state:l})}),e.jsx(N,{withoutPadding:!0,children:e.jsx(Q,{value:S,children:e.jsx(X,{autoComplete:"off",noValidate:!0,onSubmit:O,children:e.jsxs(ie,{children:[e.jsx(n,{display:"flex",justifyContent:"center",alignItems:"center",mt:4,children:e.jsx("img",{src:_,height:46})}),e.jsxs(n,{display:"flex",height:"100%",flexDirection:"column",justifyContent:"space-around",alignItems:"center",px:2,flexGrow:"1",children:[e.jsx(h,{variant:"h2",color:"text.primary",sx:{my:4},children:"Welcome Back!"}),e.jsxs(H,{spacing:2,sx:{width:"100%"},children:[e.jsx(Z,{fullWidth:!0,placeholder:"",clabel:"Email address",...L("email"),value:q.email,error:!!(u.email&&p.email),helperText:u.email&&p.email}),e.jsx(ee,{clabel:"Password",fullWidth:!0,placeholder:"",...L("password"),error:!!(u.password&&p.password),helperText:u.password&&p.password}),e.jsxs(n,{display:"flex",width:"100%",sx:{mt:1},justifyContent:"space-between",children:[e.jsx("div",{}),e.jsx(V,{onClick:()=>m("/forgotPassword"),children:e.jsx(h,{color:"primary",children:"Forgot Password ?"})})]}),e.jsx(n,{display:"flex",width:"100%",sx:{mt:1},justifyContent:"space-between",children:e.jsx(n,{display:"flex",flex:1,children:e.jsxs(D,{fullWidth:!0,variant:"contained",type:"submit",children:["Login"," "]})})})]}),e.jsxs(n,{width:"100%",my:2,children:[" ",e.jsx(ae,{children:e.jsx(h,{color:"text.secondary",sx:{px:1},children:"OR"})})]}),e.jsx(oe,{clientId:"20299471486-m23pkgk770a4vq3dgjh8uc9k180cpc98.apps.googleusercontent.com",render:o=>e.jsx(se,{sx:{mb:4,borderColor:"rgba(149, 163, 184, 1)"},onClick:o.onClick,disabled:o.disabled,fullWidth:!0,startIcon:e.jsx(M,{icon:"flat-color-icons:google",width:24,height:24}),endIcon:e.jsx(n,{width:24,height:24}),children:e.jsx(h,{variant:"h6",color:"text.primary",children:"Login with google"})}),buttonText:"Login",onSuccess:$,onFailure:o=>{console.log(o)},cookiePolicy:"single_host_origin"}),e.jsx("br",{}),e.jsx("br",{})]})]})})})})]})})}export{Fe as default};
