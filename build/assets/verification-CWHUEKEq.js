import{e as A,a as E,u as L,d as z,r as p,j as t,S as H,C as N,B as d,am as U,T as l,n as u,o as i,c,q as G,s as g}from"./index-tWVfh1a_.js";import{P as M}from"./Page-D7TsOLpr.js";import{u as q}from"./Onboarding-CSV0hQFI.js";import{H as _}from"./header-Bo2DC4uj.js";import{O as J}from"./index-DhwHdC5A.js";import{C as K}from"./index.es-dZk2dlKh.js";import"./Header-C-6_pkkN.js";import"./ArrowLeft-lA8HnlgG.js";g("div")(()=>({display:"flex",flexDirection:"column",flex:1,flexGrow:1,background:"#fff",height:"100vh"}));g(d)(()=>({position:"relative"}));g(d)(()=>({position:"absolute",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",paddingTop:52,paddingBottom:24,zIndex:100,top:0}));function ie({mode:v}){const m=A(),a=E(),r=L(s=>s.Onboarding),{state:e}=z(),[y,x]=p.useState(""),[j,k]=p.useState(Date.now()+3e4),[C,f]=p.useState(!1),S=s=>{const o=/^[0-9]*$/;let n=s.toString();o.test(n)&&(x(n),n.length===6&&$(n)),n.length==0&&x("")},w=p.useRef(null),$=s=>{u.post(`${i.protocol}${i.baseUrl}${i.verifyMail}`,{email:r.email,token:s||y,phone:r.phone,type:"email",authType:e==null?void 0:e.authType}).then(o=>{if((e==null?void 0:e.authType)=="signup")a(q({token:o.data.token})),a(c({loading:!1,snackbar:!0,message:"Account verification completed",severity:"success"})),m(`/onboarding/${v=="client"?"client/info":"preview"}`,{replace:!0,state:{...e,email:r.email,type:"email",phone:r.phone,token:o.data.token}});else{let{_id:n,category:h,name:T,bio:D,type:I,DOB:O,privatePlan:B,profilePic:P,location:R,links:V,email:W,phone:F}=o.data.userData;u.defaults.headers.common.Authorization=o.data.token,localStorage.setItem("token",o.data.token),a(G({_id:n,category:h,name:T,bio:D,type:I,DOB:O,privatePlan:B,profilePic:P,location:R,links:V,email:W,token:o.data.token,phone:F,password:"",...o.data.userData})),e.redirect&&m(e.redirect)}}).catch(o=>{if(o.response.status===406&&a(c({loading:!1,snackbar:!0,message:"Acccount with give email address already exists!",severity:"error"})),o.response.status===404)return a(c({loading:!1,snackbar:!0,message:"Invalid code!",severity:"error"}))})},b=()=>{a(c({loading:!0})),k(Date.now()+3e4),(e==null?void 0:e.type)=="phone"?u.get(`${i.protocol}${i.baseUrl}${i.sendOtp}${r.phone}`).then(s=>{f(!1),a(c({loading:!1,snackbar:!0,message:"Verification code sent",severity:"success"}))}):u.post(`${i.protocol}${i.baseUrl}${i.SendVerifyMail}`,{email:r.email}).then(s=>{f(!1),a(c({loading:!1,snackbar:!0,message:"Verification code sent",severity:"success"}))})};return t.jsx(M,{title:" Simplified Online Fitness Training ",children:t.jsxs(H,{children:[t.jsx(_,{title:(e==null?void 0:e.authType)=="login"?"Login":"Create account",onClose:()=>m("/",{state:e})}),t.jsxs(N,{children:[t.jsx(d,{display:"flex",justifyContent:"center",alignItems:"center",mt:4,children:t.jsx("img",{src:U,height:46})}),t.jsxs(d,{display:"flex",height:"100%",flexDirection:"column",alignItems:"center",flexGrow:1,px:2,children:[t.jsx(l,{variant:"h2",sx:{my:6,mb:3},children:(e==null?void 0:e.type)=="phone"?"Verify phone number":"Check your email!"}),t.jsx(l,{variant:'"body2',color:"grey.600",children:"We have sent the verification code to"}),t.jsx(l,{variant:"body2",color:"primary",sx:{my:1,fontWeight:"bold",mb:3},children:r.email}),t.jsx(d,{width:"100%",children:t.jsx(J,{value:y,onChange:S,numInputs:6,isInputNum:!0,shouldAutoFocus:!0,separator:t.jsx("span",{children:"Â "}),containerStyle:{border:"none",width:"100%",justifyContent:"space-around"},inputStyle:{borderTop:"none",borderLeft:"none",borderRight:"none",padding:10,width:48,height:64,border:"1px solid rgba(195, 203, 217, 1)",backgroundColor:"rgba(245, 247, 250, 1)",fontSize:24,color:"#2F86EB",fontWeight:"bold",boxShadow:"none",borderRadius:8,borderBottom:"1px solid rgba(195, 203, 217, 1)"},focusStyle:{outline:"none",color:"#2F86EB"}})}),t.jsx(d,{display:"flex",justifyContent:"space-between",sx:{my:3},children:C?t.jsx(l,{sx:{fontWeight:"bold",ml:2},variant:'"body2',color:"primary",onClick:b,children:"Resend code"}):t.jsx(K,{ref:w,date:j,onComplete:()=>f(!0),renderer:({hours:s,minutes:o,seconds:n,completed:h})=>h?t.jsx(l,{sx:{fontWeight:"bold",ml:2},variant:'"body2',color:"primary",onClick:b,children:"Resend code"}):t.jsxs(l,{variant:'"body2',children:["Wait until ",o,":",n," to resend"]})})})]})]})]})})}export{ie as default};
