import{r as m,a as v,d as x,U as E,e as R,j as r,C as z,c as s,B as c,Z as q,V as p,$ as U,f as T,i as V,T as $,X as I,s as d}from"./index-tWVfh1a_.js";import{h as L}from"./uploader-C1vfyOx8.js";import{I as N}from"./index-CzZqv2Gi.js";import{c as O,d as W,a as Y,b as f}from"./array-DbNmRnh0.js";import{u as X,F as Z,a as G}from"./formik.esm-jmAInz8L.js";import{S as H}from"./sendProgramEmails-BD0dy4IK.js";import{U as J}from"./updateProgramForm-CBjesxIP.js";import{A as K}from"./AddImage-CqZmaXGL.js";import"./Header-C-6_pkkN.js";import"./isObject-MojUmidT.js";import"./Page-D7TsOLpr.js";import"./InputAdornment-DiI_gVyu.js";import"./useFormControl-BEzaUW9U.js";import"./TextField-cyeEFY3i.js";import"./OutlinedInput-D3YoqtXT.js";import"./InputBase-7pV38TnQ.js";import"./Popover-COOgvQR_.js";import"./ListContext-BQPXTeBj.js";import"./useControlled-DiwPEJyR.js";import"./isMuiElement-CENM59Ut.js";import"./ArrowLeft-lA8HnlgG.js";import"./LabeledInput-B3Qf7l4R.js";import"./ProgramDescriptionModal-Dkibb7pp.js";d("div")(()=>({backgroundColor:"#fff",height:"100%"}));d(c)(()=>({position:"absolute",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",paddingTop:52,paddingBottom:24,zIndex:100,top:0}));d(T)(({theme:b})=>({height:45,borderRadius:16,background:"#F9FCFD",fontFamily:"Proxima Nova",color:"#172A44",fontSize:18,fontWeight:"bold",width:"100%",marginBottom:8,border:"2px solid rgba(23, 42, 68, 0.5)"}));d(c)(()=>({display:"flex",justifyContent:"space-between",alignItems:"end",padding:"20px 10px",maxWidth:"xs",zIndex:100,borderRadius:"0px 0px 8px 8px"}));const Fe=m.forwardRef((b,P)=>{const n=v(),{state:M}=x(),{search:B}=x();new URLSearchParams(B);const[e,l,g]=E(),S=R(),[j,Q]=m.useState(!1),F=()=>{n(s({loading:!0})),l({Price:i.price,BannerImage:i.BannerImage,Title:i.title,Description:i.description,PaymentType:i.PaymentType,IsDraft:!1}),n(I({...e,IsDraft:!1,SendTo:[],Price:i.price,BannerImage:i.BannerImage,Title:i.title,Description:i.description,PaymentType:i.PaymentType})).then(t=>{n(s({loading:!1,sAnimate:!0,message:"Program published succesfully",severity:"success"})),S("/instructor")})},k=O().shape({title:f().required("Title is required").max(24,"Title too long"),description:f().max(1e3,"Description too long"),price:Y().required("Price is required"),BannerImage:"",SendTo:W().of(f().email())}),[_,ee]=m.useState(null),u=X({initialValues:{price:e.Price,BannerImage:e.BannerImage,title:e.Title,description:e.Description,BannerImage:e.BannerImage,PaymentType:e.PaymentType||"Free",SendTo:e.SendTo.length?e.SendTo:[""]},validationSchema:k,onSubmit:async(t,{setErrors:o,setSubmitting:te})=>{g=="create"&&(n(s({loading:!0,sAnimate:!0,message:"Program created successfully",severity:"success"})),n(I({...e,Price:t.price,BannerImage:t.BannerImage,Title:t.title,Description:t.description,PaymentType:t.PaymentType,SendTo:p(e)?[]:e.SendTo,IsDraft:p(e),IsPublished:!p(e),Price:t.price,BannerImage:t.BannerImage,Title:t.title,Description:t.description,PaymentType:t.PaymentType})).then(re=>{n(s({loading:!1,sAnimate:!0,snackbar:!0,message:"Program created successfully",severity:"success"}))})),g=="edit"&&n(l({Price:t.price,BannerImage:t.BannerImage,Title:t.title,Description:t.description,PaymentType:t.PaymentType,SendTo:p(e)?[]:e.SendTo}))}}),{errors:h,touched:D,handleSubmit:y,isSubmitting:C,getFieldProps:w,setFieldValue:a,validateForm:A,values:i}=u;return m.useEffect(()=>{e.Title||a("title",null),e.Description||a("description",null),e.BannerImage||a("BannerImage",null),a("title",e.Title),a("description",e.Description),a("BannerImage",e.BannerImage),a("price",e.Price),a("PaymentType",e.PaymentType||"Subscription")},[e]),m.useEffect(()=>{P.current={errors:h,touched:D,handleSubmit:y,isSubmitting:C,handelNext:F,validateForm:A,getFieldProps:w,setFieldValue:a,values:i}},[]),r.jsxs(z,{withoutPadding:!0,style:{paddingBottom:24,overflowY:"auto"},children:[r.jsxs(Z,{value:u,children:[r.jsxs(G,{autoComplete:"off",noValidate:!0,onSubmit:y,children:[r.jsx(N,{hidden:!0,accept:"image/*",type:"file",id:"bannerImage",onChange:t=>{L(t).then(o=>{a("BannerImage",o.data.Location),n(s({loading:!1}))}).catch(o=>{n(s({loading:!1}))})},cropShape:"rect",aspect:1.5}),r.jsxs(c,{position:"relative",width:"100%",height:i.BannerImage?"auto":"248px",borderRadius:1,bgcolor:"#F5F7FA",children:[i.BannerImage&&r.jsx("img",{style:{width:"100%",height:"auto",objectFit:"cover",backgroundColor:"#fff"},onClick:t=>{var o;(o=document==null?void 0:document.getElementById("bannerImage"))==null||o.click()},src:i.BannerImage}),r.jsx(c,{sx:{position:"absolute",top:"0px",right:"0px",width:"100%",height:"100%",backgroundColor:i.BannerImage?"rgba(0,0,0,0.1)":"F5F7FA",zIndex:10,display:"flex",paddingTop:2,pl:2,justifyContent:"center",alignItems:"center"},children:r.jsx(q,{onClick:t=>{var o;t.stopPropagation(),(o=document==null?void 0:document.getElementById("bannerImage"))==null||o.click()},sx:{color:"primary.main"},children:r.jsx(K,{style:{fontSize:60},sx:{color:"primary.main"}})})})]}),r.jsxs(c,{px:2,children:[p(e)&&r.jsx(U,{alignItems:"center",severity:"warning",sx:{mb:2},children:"You must have exercise in every week to publish your program."}),r.jsx(J,{submitTriggered:j,Program:e,values:u.values,updateProgram:l})]})]}),g=="create"&&r.jsxs(c,{marginTop:2,children:[r.jsxs(T,{children:[r.jsx(V,{icon:"bi:arrow-up-right-circle",sx:{fontSize:18},color:"text.primary",ml:.5}),"  ",r.jsx($,{variant:"subtitle1",color:"text.primary",children:"Send to"})]}),r.jsx(H,{allRecievers:i.SendTo,setAllRecievers:t=>a("SendTo",t),errors:h.SendTo,errorObj:{},modal:!0,setErrorObj:()=>console.log("")})]})]}),r.jsx("br",{})]})});export{Fe as default};
