import{a as F,g as G,e as N,d as W,r as E,j as e,M as z,S as H,s as h,B as r,I as Y,C as _,m as g,v as m,L as q,T as c,h as I,i as b,k,c as l,n as p,o as a,p as J,q as K}from"./index-tWVfh1a_.js";import{G as Q}from"./google-login-TOBpJPnJ.js";import{u as v}from"./Onboarding-CSV0hQFI.js";import{M as V}from"./ModeSelection-DbpARlHA.js";import{S as X}from"./Header-C-6_pkkN.js";import{A as Z}from"./ArrowLeft-lA8HnlgG.js";import{L as w}from"./Link-D6ktmyc-.js";h(g.div)(({theme:s})=>({width:"100%",backgroundColor:"#fff",pb:2,overflowY:"auto"}));const ee=h(r)(()=>({width:"100%",zIndex:100,backgroundColor:"#fff"})),te=h(s=>e.jsx(I,{spacing:2,...s}))(({theme:s})=>({display:"flex",flexDirection:"column",maxWidth:520,margin:"auto",width:"100%",textAlign:"center",paddingLeft:8,paddingRight:8,paddingTop:s.spacing(8)}));h(c)(({theme:s})=>({position:"relative",marginRight:1,"&:after":{content:"''",position:"absolute",bottom:"-5px",left:0,height:"7px",width:"100%",border:"solid 2px #cb1829",borderColor:"#cb1829 transparent transparent transparent",borderTopColor:s.palette.primary.main,borderRadius:"50%"}}));const C=h(J)(({theme:s})=>({height:52,alignItems:"center",borderRadius:8,boxShadow:"0px 4px 4px 0px #2B40571A",background:"#fff",border:"1.5px solid #C3CBD9",borderColor:"#C3CBD9",fontFamily:"Proxima Nova",paddingLeft:"12px",color:"#172A44",fontSize:16,fontWeight:"bold"}));function ce({mode:s}){const i=F(),x=G(),f=N(),{state:n}=W(),[S,y]=E.useState(!1),j=t=>{i(l({loading:!0})),p.post(`${a.protocol}${a.baseUrl}${a.userLogin}`,{email:t==null?void 0:t.profileObj.email,authType:"gmail",phone:"",tokenId:t.tokenId}).then(o=>{i(l({loading:!1,snackbar:!0,message:"Login successfuly",severity:"success"}));let{_id:d,category:u,name:$,bio:B,type:L,DOB:A,privatePlan:D,profilePic:M,location:O,links:R,email:P,phone:U}=o.data.userData;p.defaults.headers.common.Authorization=o.data.token,localStorage.setItem("token",o.data.token),i(K({_id:d,category:u,name:$,bio:B,type:L,authType:"gmail",DOB:A,privatePlan:D,profilePic:M,location:O,links:R,email:P,token:o.data.token,phone:U,password:"",...o.data.userData})),n.redirect&&f(n.redirect)}).catch(o=>{if(o.response&&o.response.status===404)return i(l({loading:!1,snackbar:!0,message:"User with provided email or phone doesn't exist",severity:"error"}));if(o.response&&o.response.status===409)return i(l({loading:!1,snackbar:!0,message:"Invalid Password",severity:"error"}));o.response&&o.response.status===408&&(i(l({loading:!1})),x.showConfirmationModal("Alert!","This email is already registered with other auth provide , would you like to link gmail with this account?","Yes","No").then(d=>{d&&(i(l({loading:!0})),p.patch(`${a.protocol}${a.baseUrl}${a.updateAuth}`,{email:t==null?void 0:t.profileObj.email,authType:"gmail",tokenId:t.tokenId}).then(u=>{i(l({loading:!1,snackbar:!0,message:"Account linked with gmail , login to continue",severity:"success"}))}))}))})},T=t=>{i(l({loading:!0})),p.get(`${a.protocol}${a.baseUrl}${a.checkUserExistence}email=${t==null?void 0:t.profileObj.email}`).then(o=>{i(l({loading:!1})),o.data.authType.includes("gmail")?j(t):x.showConfirmationModal("Alert!","This email is already registered with other auth provide , would you like to link gmail with this account?","Yes","No").then(d=>{d&&(i(l({loading:!0})),p.patch(`${a.protocol}${a.baseUrl}${a.updateAuth}`,{email:o.data.email,authType:"gmail",tokenId:t.tokenId}).then(u=>{j(t)}))})}).catch(o=>{i(l({loading:!1})),o.response.status===404&&(i(v({name:t==null?void 0:t.profileObj.name,email:t==null?void 0:t.profileObj.email,profilePic:t==null?void 0:t.profileObj.imageUrl,tokenId:t.tokenId,authType:"gmail"})),y(!0))})};return e.jsx(z,{children:e.jsxs(H,{children:[e.jsx(X,{style:{borderRadius:"0px 0px 8px 8px",overflow:"hidden"},children:e.jsxs(ee,{px:2,py:2,children:[e.jsxs(r,{display:"flex",alignItems:"center",children:[" ",e.jsx(Y,{onClick:()=>f(-1),sx:{color:"text.primary"},children:e.jsx(Z,{})})]})," "]})}),e.jsx(_,{children:e.jsxs(te,{children:[e.jsx(g.div,{variants:m().inRight,children:e.jsx(r,{display:"flex",justifyContent:"center",children:e.jsx("img",{src:q,height:64})})}),e.jsx(g.div,{variants:m().inRight,children:e.jsx(c,{align:"center",sx:{fontWeight:"500",fontSize:24},color:"text.primary",children:(n==null?void 0:n.type)=="signin"?"Sign in":"Welcome to circled.fit"})}),e.jsx(c,{color:"text.secondary",align:"center",sx:{mt:1},children:(n==null?void 0:n.type)=="signin"?e.jsxs(e.Fragment,{children:["Sign to your circled account and",e.jsx("br",{})," Enjoy your journey"]}):e.jsxs(e.Fragment,{children:["Sign up and start building your program or ",e.jsx("br",{}),"If you have an account we’ll log you in."]})}),e.jsx(r,{display:"flex",alignItems:"center",width:"100%",justifyContent:"center",flexGrow:1,children:e.jsx(g.div,{variants:m().inRight,style:{width:"100%"},children:e.jsxs(I,{spacing:2,children:[e.jsx(r,{children:e.jsx(Q,{clientId:"20299471486-m23pkgk770a4vq3dgjh8uc9k180cpc98.apps.googleusercontent.com",render:t=>e.jsxs(C,{style:{marginTop:16},onClick:t.onClick,disabled:t.disabled,fullWidth:!0,children:[e.jsx(b,{icon:"flat-color-icons:google",width:24,height:24}),"  ",e.jsx(c,{variant:"h6",color:"text.primary",children:"Sign up with Google"})]}),buttonText:"Login",onSuccess:T,onFailure:t=>{console.log(t)},cookiePolicy:"single_host_origin"})}),e.jsx(r,{children:e.jsxs(C,{onClick:()=>{i(v({authType:"email"})),y(!0)},fullWidth:!0,style:{marginTop:16,marginBottom:16},children:[e.jsx(b,{icon:"fontisto:email",width:24,height:24}),"   ",e.jsx(c,{variant:"h6",color:"text.primary",children:"Sign up with Email"})]})}),e.jsx(r,{children:e.jsx(c,{color:"text.secondary",children:(n==null?void 0:n.type)=="signin"?"If you don’t have an account we will sign you up":"If you have an account we’ll log you in."})})]})})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(r,{display:"flex",alignItems:"flex-end",justifyContent:"center",children:e.jsxs(c,{align:"center",color:"text.secondary",style:{marginBottom:16},children:["By continuing, you agree to Circled.fit",e.jsx("br",{}),e.jsx(w,{variant:"subtitle2",component:k,to:"/terms",color:"text.secondary",sx:{textDecoration:"underline"},children:"Terms of Service"})," and ",e.jsx(w,{variant:"subtitle2",component:k,to:"/privacy",color:"text.secondary",sx:{textDecoration:"underline"},children:"Privacy Policy"})]})})]})}),e.jsx(V,{open:S,state:n})]})})}export{ce as default};
