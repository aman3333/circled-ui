import{D as M,A,r as g,E as z,F as P,G as b,j as r,s as B,H as L,J as m,K as N,w as U,B as u,bC as k,i as _,T,p as F,bi as E}from"./index-tWVfh1a_.js";import{T as x,E as S,O as w,P as I,i as O,w as $,S as H,a as W,c as G,u as q,b as R,d as C,R as V,e as J}from"./index.es-nfKkgyUc.js";import{L as K}from"./LightBoxContainer-BsEAh_HD.js";import{h as Y}from"./uploader-C1vfyOx8.js";function Q(e){return M("MuiIcon",e)}A("MuiIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const X=["baseClassName","className","color","component","fontSize"],Z=e=>{const{color:t,fontSize:o,classes:s}=e,i={root:["root",t!=="inherit"&&`color${m(t)}`,`fontSize${m(o)}`]};return N(i,Q,s)},ee=B("span",{name:"MuiIcon",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,o.color!=="inherit"&&t[`color${m(o.color)}`],t[`fontSize${m(o.fontSize)}`]]}})(({theme:e,ownerState:t})=>({userSelect:"none",width:"1em",height:"1em",overflow:"hidden",display:"inline-block",textAlign:"center",flexShrink:0,fontSize:{inherit:"inherit",small:e.typography.pxToRem(20),medium:e.typography.pxToRem(24),large:e.typography.pxToRem(36)}[t.fontSize],color:{primary:(e.vars||e).palette.primary.main,secondary:(e.vars||e).palette.secondary.main,info:(e.vars||e).palette.info.main,success:(e.vars||e).palette.success.main,warning:(e.vars||e).palette.warning.main,action:(e.vars||e).palette.action.active,error:(e.vars||e).palette.error.main,disabled:(e.vars||e).palette.action.disabled,inherit:void 0}[t.color]})),D=g.forwardRef(function(t,o){const s=z({props:t,name:"MuiIcon"}),{baseClassName:i="material-icons",className:n,color:a="inherit",component:l="span",fontSize:f="medium"}=s,p=P(s,X),c=b({},s,{baseClassName:i,color:a,component:l,fontSize:f}),h=Z(c);return r.jsx(ee,b({as:l,className:L(i,"notranslate",h.root,n),ownerState:c,"aria-hidden":!0,ref:o},p))});D.muiName="Icon";const te=["ase","art","bmp","blp","cd5","cit","cpt","cr2","cut","dds","dib","djvu","egt","exif","gif","gpl","grf","icns","ico","iff","jng","jpeg","jpg","jfif","jp2","jps","lbm","max","miff","mng","msp","nitf","ota","pbm","pc1","pc2","pc3","pcf","pcx","pdn","pgm","PI1","PI2","PI3","pict","pct","pnm","pns","ppm","psb","psd","pdd","psp","px","pxm","pxr","qfx","raw","rle","sct","sgi","rgb","int","bw","tga","tiff","tif","vtf","xbm","xcf","xpm","3dv","amf","ai","awg","cgm","cdr","cmx","dxf","e2d","egt","eps","fs","gbr","odg","svg","stl","vrml","x3d","sxd","v2d","vnd","wmf","emf","art","xar","png","webp","jxr","hdp","wdp","cur","ecw","iff","lbm","liff","nrrd","pam","pcx","pgf","sgi","rgb","rgba","bw","int","inta","sid","ras","sun","tga"];var se=ie,oe=/^(?:\w+:)?\/\/(\S+)$/,re=/^localhost[\:?\d]*(?:[^\:?\d]\S*)?$/,ne=/^[^\s\.]+\.\S{2,}$/;function ie(e){if(typeof e!="string")return!1;var t=e.match(oe);if(!t)return!1;var o=t[1];return o?!!(re.test(o)||ne.test(o)):!1}const ae=U(se);var le={isHistory(e){return O(e)&&Array.isArray(e.redos)&&Array.isArray(e.undos)&&(e.redos.length===0||w.isOperationList(e.redos[0].operations))&&(e.undos.length===0||w.isOperationList(e.undos[0].operations))}},y=new WeakMap,v=new WeakMap,d={isHistoryEditor(e){return le.isHistory(e.history)&&S.isEditor(e)},isMerging(e){return v.get(e)},isSaving(e){return y.get(e)},redo(e){e.redo()},undo(e){e.undo()},withoutMerging(e,t){var o=d.isMerging(e);v.set(e,!1),t(),v.set(e,o)},withoutSaving(e,t){var o=d.isSaving(e);y.set(e,!1),t(),y.set(e,o)}},ce=e=>{var t=e,{apply:o}=t;return t.history={undos:[],redos:[]},t.redo=()=>{var{history:s}=t,{redos:i}=s;if(i.length>0){var n=i[i.length-1];n.selectionBefore&&x.setSelection(t,n.selectionBefore),d.withoutSaving(t,()=>{S.withoutNormalizing(t,()=>{for(var a of n.operations)t.apply(a)})}),s.redos.pop(),s.undos.push(n)}},t.undo=()=>{var{history:s}=t,{undos:i}=s;if(i.length>0){var n=i[i.length-1];d.withoutSaving(t,()=>{S.withoutNormalizing(t,()=>{var a=n.operations.map(w.inverse).reverse();for(var l of a)t.apply(l);n.selectionBefore&&x.setSelection(t,n.selectionBefore)})}),s.redos.push(n),s.undos.pop()}},t.apply=s=>{var{operations:i,history:n}=t,{undos:a}=n,l=a[a.length-1],f=l&&l.operations[l.operations.length-1],p=d.isSaving(t),c=d.isMerging(t);if(p==null&&(p=de(s)),p){if(c==null&&(l==null?c=!1:i.length!==0?c=!0:c=pe(s,f)),l&&c)l.operations.push(s);else{var h={operations:[s],selectionBefore:t.selection};a.push(h)}for(;a.length>100;)a.shift();n.redos=[]}o(s)},t},pe=(e,t)=>!!(t&&e.type==="insert_text"&&t.type==="insert_text"&&e.offset===t.offset+t.text.length&&I.equals(e.path,t.path)||t&&e.type==="remove_text"&&t.type==="remove_text"&&e.offset+e.text.length===t.offset&&I.equals(e.path,t.path)),de=(e,t)=>e.type!=="set_selection";const Ee=({onChange:e,value:t})=>{const o=g.useMemo(()=>fe(ce($(G()))),[]);return r.jsx(H,{editor:o,value:[...t],onChange:s=>{if(o.operations.some(n=>n.type!=="set_selection")){const n=JSON.stringify(s);e(n)}},children:r.jsx(u,{height:"100%",pb:2,children:r.jsx(u,{py:4,pb:8,height:"100%",children:r.jsxs(u,{px:2,children:[r.jsx(ye,{}),r.jsx(W,{renderLeaf:s=>r.jsx(xe,{...s}),renderElement:s=>r.jsx(ue,{...s}),placeholder:"Write your meal plan here..."})]})})})})},fe=e=>{const{insertData:t,isVoid:o}=e;return e.isVoid=s=>s.type==="image"?!0:o(s),e.insertData=s=>{const i=s.getData("text/plain"),{files:n}=s;if(n&&n.length>0)for(const a of n){const l=new FileReader,[f]=a.type.split("/");f==="image"&&(l.addEventListener("load",()=>{const p=l.result;j(e,p)}),l.readAsDataURL(a))}else ve(i)?j(e,i):t(s)},e},j=(e,t)=>{const o={text:" "},s=[{type:"image",url:t,children:[o]},{type:"paragraph",children:[o]}];x.insertNodes(e,s)},ue=e=>{const{attributes:t,children:o,element:s}=e;switch(s.type){case"image":return r.jsx(ge,{...e});default:return r.jsx("p",{...t,children:o})}},ge=({attributes:e,children:t,element:o})=>{const s=C(),i=V.findPath(s,o),n=J(),a=R();return r.jsxs("div",{...e,children:[t,r.jsxs("div",{contentEditable:!1,style:{position:"relative"},children:[r.jsx(K,{image:o.url,children:r.jsx("img",{src:o.url,style:{borderRadius:"8px",display:"block",maxWidth:"100%",maxHeight:"20em",boxShadow:n&&a?"0 0 0 3px #B4D5FF":"none"}})}),r.jsx(F,{active:!0,onClick:()=>x.removeNodes(s,{at:i}),style:{display:n&&a?"inline":"none",position:"absolute",top:"0.5em",left:"0.5em",background:"white"},children:r.jsx(D,{children:"delete"})})]})]})},me=()=>{const e=C(),t=o=>{E({type:"UPDATE_FEED",payload:{loading:!0}}),Y(o).then(s=>{E({type:"UPDATE_FEED",payload:{loading:!1}}),j(e,s.data.Location)})};return r.jsxs(r.Fragment,{children:[r.jsx("input",{type:"file",id:"dietEditor",accept:"image/*",onChange:t,style:{display:"none"}}),r.jsx(_,{icon:"ph:image",width:24,height:24,color:"text.secondary",mr:.5,onClick:()=>{document.getElementById("dietEditor").click()}}),r.jsx(T,{color:"text.secondary",onClick:()=>{document.getElementById("dietEditor").click()},children:"Upload image here"})]})},xe=({attributes:e,children:t,leaf:o})=>(o.bold&&(t=r.jsx("strong",{children:t})),o.italic&&(t=r.jsx("em",{children:t})),o.underlined&&(t=r.jsx("u",{children:t})),r.jsx("span",{...e,children:t})),he=({children:e})=>typeof document=="object"?k.createPortal(e,document.body):null,ye=()=>{const e=g.useRef(),t=q(),o=R();return g.useEffect(()=>{const s=e.current,{selection:i}=t;if(!s)return;if(!o){s.removeAttribute("style");return}const l=window.getSelection().getRangeAt(0).getBoundingClientRect();s.style.opacity="1",s.style.top=`${l.top+window.pageYOffset+36}px`,s.style.left=`${Math.min(l.left,window.innerWidth-s.offsetWidth-20)}px`}),r.jsx(he,{children:r.jsx(u,{ref:e,sx:{padding:"8px 7px 6px",position:"absolute",zIndex:1,top:"-10000px",left:"-10000px",marginTop:"-6px",opacity:0,display:"flex",backgroundColor:"#fafafa",borderRadius:"4px",boxShadow:"0 1px 5px rgba(0,0,0,.2)",transition:"opacity 0.75s"},onMouseDown:s=>{s.preventDefault()},children:r.jsx(me,{})})})},ve=e=>{if(!e||!ae(e))return!1;const t=new URL(e).pathname.split(".").pop();return te.includes(t)};export{Ee as S};
