import{r as h,a as H,d as L,g as _,U as X,e as J,j as t,C as K,c,h as Y,T as p,s as T,B as l,f as Q,Y as se,Z as le,i as z,V as a,$ as ce,W as q,X as F,N as de,a0 as me,a1 as pe,p as M}from"./index-tWVfh1a_.js";import{L as U}from"./LabeledInput-B3Qf7l4R.js";import{c as ee,a as Z,b as V,d as ge}from"./array-DbNmRnh0.js";import{u as te,F as re,a as ie}from"./formik.esm-jmAInz8L.js";import{h as ne}from"./uploader-C1vfyOx8.js";import{I as ae}from"./index-CzZqv2Gi.js";import{D as ue,W as he}from"./calenderFormatPopover-ykbtVjF8.js";import{W as fe}from"./ProgramDescriptionModal-Dkibb7pp.js";import{I as v}from"./InputAdornment-DiI_gVyu.js";import{S as xe}from"./ProgramTypePopover-SwnXS8w9.js";import{R as ye}from"./index-HzyBoqWI.js";import{B as Pe}from"./Badge-ekxejyFm.js";import{D as be}from"./Divider-0_Mpg1Be.js";import{G as Te}from"./Grid-C2UtAwNz.js";const Ie=(g,I,n)=>{const j=g.ExercisePlan.weeks.slice(I-1,n);for(let f of j)for(let i of f.days)if(i.Exercise.length>0)return!0;return!1};T("div")(()=>({display:"flex",flexDirection:"column",flex:1,flexGrow:1,height:"100vh"}));const je=T(l)(()=>({display:"flex",justifyContent:"space-between",alignItems:"center",maxWidth:"xs",zIndex:100,borderRadius:"0px 0px 8px 8px"}));T(l)(()=>({position:"absolute",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",paddingTop:52,paddingBottom:24,zIndex:100,top:0}));T(Q)(({theme:g})=>({height:45,borderRadius:16,background:"#F9FCFD",fontFamily:"Proxima Nova",color:"#172A44",fontSize:18,fontWeight:"bold",width:"100%",marginBottom:8,border:"2px solid rgba(23, 42, 68, 0.5)"}));const Ye=h.forwardRef((g,I)=>{const n=H(),{state:j}=L(),f=_(),[i,w,r]=X(),{search:B}=L();new URLSearchParams(B);const[u,k]=h.useState(i.ExercisePlan.weeks.length?i.ExercisePlan.weeks.length:4),[A,C]=h.useState(i.Type?i.Type:"Easy"),R=e=>{if(e>u){k(e),m("Duration",e);return}else if(Ie(i,e,u))f.showConfirmationModal("Alert!","Reducing week in already created calendar will delete all the workouts of deleted week. Do you want to continue?","Yes","No").then(o=>{o&&(k(e),m("Duration",e))});else{k(e),m("Duration",e);return}},$=e=>{m("calendarType",e),n(w({calendarType:e}))};J();const G=ee().shape({title:V().required("Title is required").max(50,"Title too long"),price:Z().required("Price is required"),totalClients:Z().required("Required")}),x=te({initialValues:{title:i.Title||"",description:i.Description||"",BannerImage:i.BannerImage,price:i.Price,PaymentType:i.PaymentType||"Free",ProgramType:i.ProgramType||"Public",maximumClient:i.maximumClient||"Unlimited",totalClients:i.totalClients||10,calendarType:i.calendarType||"Standard days"},validationSchema:G,onSubmit:async(e,{setErrors:o,setSubmitting:oe})=>{let s=[...i.ExercisePlan.weeks];u<i.Duration&&s.splice(u,i.Duration-1),u>i.Duration&&new Array(u-i.Duration).fill(0).map(b=>(s.push({days:[{Title:"",IsRest:!1,Exercise:[],Cover:null},{Title:"",IsRest:!1,Exercise:[],Cover:null},{Title:"",IsRest:!1,Exercise:[],Cover:null},{Title:"",IsRest:!1,Exercise:[],Cover:null},{Title:"",IsRest:!1,Exercise:[],Cover:null},{Title:"",IsRest:!1,Exercise:[],Cover:null},{Title:"",IsRest:!1,Exercise:[],Cover:null}]}),"dsf")),n(w({Title:e.title,Description:e.description,BannerImage:e.BannerImage,Duration:u||4,Price:e.price,ProgramType:e.ProgramType,ExercisePlan:{...i.ExercisePlan,weeks:s}}))}}),{errors:y,touched:P,handleSubmit:D,isSubmitting:W,isValid:N,validateForm:d,getFieldProps:S,setFieldValue:m,values:E}=x;return h.useEffect(()=>{I.current={errors:y,touched:P,handleSubmit:D,isSubmitting:W,validateForm:d,getFieldProps:S,setFieldValue:m,values:E}},[]),t.jsx(K,{withoutPadding:!0,style:{paddingBottom:24,background:"#fff"},children:t.jsx(re,{value:x,children:t.jsxs(ie,{autoComplete:"off",noValidate:!0,onSubmit:D,children:[t.jsx(ae,{hidden:!0,accept:"image/*",type:"file",id:"bannerImage",onChange:e=>{n(c({loading:!0})),ne(e).then(o=>{m("BannerImage",o.data.Location),n(c({loading:!1}))})},cropShape:"rect",aspect:1.5}),t.jsx("br",{}),t.jsx("br",{}),t.jsxs(Y,{spacing:3,sx:{width:"100%",px:2},children:[t.jsx(U,{fullWidth:!0,placeholder:"Example: Muscle build",maxLength:50,clabel:"Program title",...S("title"),error:!!(P.title&&y.title),helperText:P.title&&y.title,inputProps:{maxLength:50},InputProps:{endAdornment:t.jsx(v,{position:"end",children:t.jsx(p,{variant:"body2",color:"text.secondary",children:(x.values.title+"").length+"/50"})})}}),t.jsxs(je,{children:[t.jsxs(l,{width:"100%",children:[t.jsx(p,{variant:"subtitle1",mb:1,children:"Duration"})," ",t.jsx(ue,{selectedDuration:u,setSelectedDuration:R})]})," ","  ",t.jsxs(l,{width:"100%",children:[t.jsx(p,{variant:"subtitle1",mx:1,mb:1,children:"Calendar format"})," ",t.jsx(he,{setSelectedType:$,selectedType:E.calendarType})]})]}),t.jsx(fe,{headerTitle:"Create program",headerSubTitle:"About",fullWidth:!0,placeholder:"Write about your progam....",clabel:"Program description",...S("description"),error:!!(P.description&&y.description),helperText:P.description&&y.description,multiline:!0,minRows:6,inputProps:{maxLength:1e3},endAdornment:t.jsx(v,{position:"end",sx:{height:"100%",pt:4},children:t.jsx(l,{position:"absolute",bottom:12,right:16,height:"100%",display:"flex",flexDirection:"column",justifyContent:"flex-end",children:t.jsx(p,{variant:"body2",color:"text.secondary",children:(x.values.description+"").length+"/1000"})})}),children:t.jsx(U,{fullWidth:!0,placeholder:"Write about your progam.... ",clabel:"About",...S("description"),error:!!(P.description&&y.description),helperText:P.description&&y.description||"Describe your program for athletes so they know what to expect",multiline:!0,minRows:8,inputProps:{maxLength:1e3},InputProps:{readOnly:!0,endAdornment:t.jsx(v,{position:"end",sx:{height:"100%",pt:2},children:t.jsx(l,{position:"absolute",bottom:12,right:16,height:"100%",display:"flex",flexDirection:"column",justifyContent:"flex-end",children:t.jsx(p,{variant:"body2",color:"text.secondary",children:(x.values.description+"").length+"/1000"})})})}})})]})," "]})})})});function we(g){return t.jsx(se,{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",...g,children:t.jsx("path",{d:"M32.36 0H7.64001C3.44001 0 0 3.42001 0 7.64001V32.36C0 36.58 3.44001 40 7.64001 40H32.36C36.58 40 40 36.58 40 32.36V7.64001C40 3.42001 36.58 0 32.36 0ZM12.3 7.82001C13.98 7.82001 15.34 9.17999 15.34 10.86C15.34 12.54 13.98 13.9 12.3 13.9C10.62 13.9 9.26001 12.54 9.26001 10.86C9.26001 9.17999 10.62 7.82001 12.3 7.82001ZM37 32.36C37 34.92 34.92 37 32.36 37H7.64001C5.08001 37 3 34.92 3 32.36V31.52L9.64001 24.88C10.24 24.26 11.26 24.26 11.88 24.88L13.68 26.7C15.46 28.48 18.38 28.48 20.16 26.7L28.14 18.72C28.74 18.1 29.76 18.1 30.38 18.72L37 25.34V32.36Z",fill:"#95A3B8"})})}T("div")(()=>({backgroundColor:"#fff",height:"100%"}));T(l)(()=>({position:"absolute",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",paddingTop:52,paddingBottom:24,zIndex:100,top:0}));T(Q)(({theme:g})=>({height:45,borderRadius:16,background:"#F9FCFD",fontFamily:"Proxima Nova",color:"#172A44",fontSize:18,fontWeight:"bold",width:"100%",marginBottom:8,border:"2px solid rgba(23, 42, 68, 0.5)"}));T(l)(()=>({display:"flex",justifyContent:"space-between",alignItems:"end",padding:"20px 10px",maxWidth:"xs",zIndex:100,borderRadius:"0px 0px 8px 8px"}));const $e=h.forwardRef((g,I)=>{const n=H(),{state:j}=L(),{showConfirmationModal:f}=_(),{search:i}=L(),{handleBack:w}=g;new URLSearchParams(i);const[r,B,u]=X(),[k,A]=h.useState(!1),C=J(),R=ee().shape({message:V(),SendTo:ge().of(V().email())}),[$,G]=h.useState(null),x=te({initialValues:{price:r.Price,BannerImage:r.BannerImage,title:r.Title,description:r.Description,ProgramType:r.ProgramType||"Public",message:"",PaymentType:r.PaymentType||"Free",SendTo:r.SendTo.length?r.SendTo.map(e=>e.toLowerCase()):[""]},validationSchema:R,onSubmit:async(e,{setErrors:o,setSubmitting:oe})=>{u=="create"&&(x.values.message&&!x.values.SendTo.filter(s=>s).length?f("",`You wrote a message but did not include 
            the client's email addresses.
            `,"Add email","Skip and publish").then(s=>{s?document.getElementById("addmore").click():a(r)?f("Save as draft?",`Your week ${q(r)} is currently empty. Please add at least one workout or delete the week to proceed with publishing the program`,"Continue","Save as draft").then(b=>{b?w():(n(c({loading:!0,sAnimate:!1,message:"Program created successfully",severity:"success"})),n(F({...r,Price:e.price,BannerImage:e.BannerImage,Title:e.title,Description:e.description,PaymentType:e.PaymentType,SendTo:a(r)?[]:e.SendTo.map(O=>O.toLowerCase()),IsDraft:a(r),IsPublished:!a(r),Price:e.price,BannerImage:e.BannerImage,Title:e.title,Description:e.description,PaymentType:e.PaymentType,GreetingMessage:e.message})).then(O=>{a(r)?n(c({loading:!1,sAnimate:!0,snackbar:!1,message:"Program saved as draft",severity:"success"})):n(c({loading:!1,sAnimate:!0,snackbar:!1,message:"Program created successfully",severity:"success"})),C("/instructor")}))}):(n(c({loading:!0,sAnimate:!1,message:"Program created successfully",severity:"success"})),n(F({...r,Price:e.price,BannerImage:e.BannerImage,Title:e.title,Description:e.description,PaymentType:e.PaymentType,SendTo:a(r)?[]:e.SendTo.map(b=>b.toLowerCase()),IsDraft:a(r),IsPublished:!a(r),Price:e.price,BannerImage:e.BannerImage,Title:e.title,Description:e.description,PaymentType:e.PaymentType,GreetingMessage:e.message})).then(b=>{A(!0)}))}):a(r)?f("Save as draft?",`Your week ${q(r)} is currently empty. Please add at least one workout or delete the week to proceed with publishing the program`,"Continue","Save as draft").then(s=>{s?w():(n(c({loading:!0,sAnimate:!1,message:"Program created successfully",severity:"success"})),n(F({...r,Price:e.price,BannerImage:e.BannerImage,Title:e.title,Description:e.description,PaymentType:e.PaymentType,SendTo:a(r)?[]:e.SendTo.map(b=>b.toLowerCase()),IsDraft:a(r),IsPublished:!a(r),Price:e.price,BannerImage:e.BannerImage,Title:e.title,Description:e.description,PaymentType:e.PaymentType,GreetingMessage:e.message})).then(b=>{a(r)?n(c({loading:!1,sAnimate:!0,snackbar:!1,message:"Program saved as draft",severity:"success"})):n(c({loading:!1,sAnimate:!0,snackbar:!1,message:"Program created successfully",severity:"success"})),C("/instructor")}))}):(n(c({loading:!0,sAnimate:!1,message:"Program created successfully",severity:"success"})),n(F({...r,Price:e.price,BannerImage:e.BannerImage,Title:e.title,Description:e.description,PaymentType:e.PaymentType,SendTo:a(r)?[]:e.SendTo.map(s=>s.toLowerCase()),IsDraft:a(r),IsPublished:!a(r),Price:e.price,BannerImage:e.BannerImage,Title:e.title,Description:e.description,PaymentType:e.PaymentType,GreetingMessage:e.message})).then(s=>{a(r)?(n(c({loading:!1,sAnimate:!0,snackbar:!1,message:"Program saved as draft",severity:"success"})),C("/instructor")):A(!0)}))),u=="edit"&&n(B({Price:e.price,BannerImage:e.BannerImage,Title:e.title,Description:e.description,PaymentType:e.PaymentType,SendTo:a(r)?[]:e.SendTo.map(s=>s.toLowerCase())})).then(s=>{C("/instructor")})}}),{errors:y,touched:P,handleSubmit:D,isSubmitting:W,getFieldProps:N,setFieldValue:d,validateForm:S,values:m}=x;h.useEffect(()=>{r.Title||d("title",null),r.Description||d("description",null),r.BannerImage||d("BannerImage",null),d("title",r.Title),d("description",r.Description),d("BannerImage",r.BannerImage),d("price",r.Price),d("PaymentType",r.PaymentType||"Subscription")},[r]),h.useEffect(()=>{I.current={errors:y,touched:P,handleSubmit:D,isSubmitting:W,validateForm:S,getFieldProps:N,setFieldValue:d,values:m}},[]);const E=e=>{d("ProgramType",e)};return t.jsxs(K,{withoutPadding:!0,style:{paddingBottom:24,overflowY:"auto"},children:[t.jsx(re,{value:x,validateOnBlur:!0,children:t.jsxs(ie,{autoComplete:"off",noValidate:!0,onSubmit:D,validateOnBlur:!0,children:[t.jsx(ae,{hidden:!0,accept:"image/*",type:"file",id:"bannerImage",onChange:e=>{n(c({loading:!0})),ne(e).then(o=>{d("BannerImage",o.data.Location),n(c({loading:!1}))})},cropShape:"rect",aspect:1.5}),t.jsxs(l,{position:"relative",width:"100%",height:m.BannerImage?"auto":"248px",mt:-2,borderRadius:1,bgcolor:"#F5F7FA",children:[m.BannerImage&&t.jsx("img",{style:{width:"100%",height:"auto",objectFit:"cover",backgroundColor:"#fff"},onClick:e=>{var o;(o=document==null?void 0:document.getElementById("bannerImage"))==null||o.click()},src:m.BannerImage}),t.jsxs(l,{sx:{position:"absolute",top:"0px",right:"0px",width:"100%",height:"100%",backgroundColor:m.BannerImage?"rgba(0,0,0,0.1)":"#F5F7FA",zIndex:10,display:"flex",paddingTop:6,justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[t.jsx(Pe,{overlap:"circular",anchorOrigin:{vertical:"top",horizontal:"right"},badgeContent:t.jsx(le,{size:"small",sx:{backgroundColor:"primary.main",padding:0,border:"2px solid #fff"},children:t.jsx(z,{icon:"fluent:add-24-filled",width:16,height:16,color:"common.white",onClick:e=>{var o;e.stopPropagation(),(o=document==null?void 0:document.getElementById("bannerImage"))==null||o.click()}})}),children:t.jsx(we,{icon:"bi:image-fill",sx:{fontSize:36},color:"#95A3B8",onClick:e=>{var o;e.stopPropagation(),(o=document==null?void 0:document.getElementById("bannerImage"))==null||o.click()}})}),t.jsx(p,{sx:{mt:1},color:"text.secondary",children:"Background"})]})]}),t.jsxs(l,{px:2,children:[t.jsxs(Y,{spacing:2,children:[a(r)&&t.jsx(ce,{alignItems:"center",sx:{color:"text.primary",mt:2},severity:"info",children:"You must have exercise in every week to publish your program."}),t.jsxs(l,{pt:2,children:[t.jsx(p,{variant:"subtitle1",color:"textPrimary",sx:{textTransform:"capitalize"},children:"Program title"}),t.jsx(p,{mt:.5,variant:"body1",color:"textPrimary",sx:{textTransform:"capitalize"},children:r.Title})]}),t.jsxs(l,{children:[t.jsx(p,{variant:"subtitle1",color:"textPrimary",sx:{textTransform:"capitalize"},children:"Description"}),t.jsx(ye,{charLimit:120,readMoreText:"more",readLessText:"less",readMoreStyle:{fontWeight:"bold",color:"#2B4057",marginLeft:6},readLessStyle:{fontWeight:"bold",color:"#2B4057",marginLeft:6},children:r.Description||"No description provided"})]}),t.jsx(be,{}),t.jsx(Te,{container:!0,sx:{px:1}})]}),t.jsxs(l,{width:"50%",children:[t.jsxs(l,{display:"flex",alignItems:"center",sx:{mb:.5},children:[t.jsx(p,{variant:"subtitle1",color:"text.primary",children:"Program type"})," "]}),t.jsx(xe,{selectedProgramType:m.ProgramType,setProgramType:E})]})]})]})}),t.jsx(Ce,{programId:r._id,dispatch:n,navigate:C,open:k})]})}),Ce=({programId:g,dispatch:I,navigate:n,open:j})=>{const[f,i]=h.useState(j);h.useEffect(()=>{i(j)},[j]);const w=()=>{navigator.share&&navigator.share({title:" shared a fitness program :",url:`/public/workout-program/${g}`})},r=()=>{navigator.clipboard.writeText(`${window.location.origin}/public/workout-program/${g}`),I(c({snackbar:!0,message:"Copied to clipboard"}))},B=()=>{n("/"),i(!1)};return t.jsx(de,{open:f,fullWidth:!0,fullScreen:!0,onClose:()=>i(!1),children:t.jsxs(Y,{spacing:2,px:3,alignItems:"center",justifyContent:"center",height:"100%",children:[f&&t.jsx(me,{autoplay:!0,animationData:pe,loop:!0,height:100,width:100}),t.jsx(p,{variant:"h3",align:"center",color:"text.primary",children:"Program created successfully"}),t.jsx(p,{variant:"body1",align:"center",color:"text.primary",children:"Your program has been created successfully. You can now share it with your clients."}),t.jsxs(M,{fullWidth:!0,variant:"contained",color:"primary",onClick:w,children:[t.jsx(z,{icon:"mdi:share",width:32,height:32}),"     Share"]}),t.jsxs(M,{fullWidth:!0,variant:"outlined",color:"primary",onClick:r,children:[t.jsx(z,{icon:"mdi:link",width:32,height:32}),"     Copy link"]}),t.jsx(M,{fullWidth:!0,variant:"outlined",color:"primary",onClick:B,children:"Done"})]})})};export{$e as P,Ye as S};
